{
  "version": 3,
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/node_modules/@supabase/realtime-js/dist/module/lib/transformers.js"],"sourcesContent":["/**\n * Helpers to convert the change Payload into native JS types.\n */\n// Adapted from epgsql (src/epgsql_binary.erl), this module licensed under\n// 3-clause BSD found here: https://raw.githubusercontent.com/epgsql/epgsql/devel/LICENSE\nexport var PostgresTypes;\n(function (PostgresTypes) {\n    PostgresTypes[\"abstime\"] = \"abstime\";\n    PostgresTypes[\"bool\"] = \"bool\";\n    PostgresTypes[\"date\"] = \"date\";\n    PostgresTypes[\"daterange\"] = \"daterange\";\n    PostgresTypes[\"float4\"] = \"float4\";\n    PostgresTypes[\"float8\"] = \"float8\";\n    PostgresTypes[\"int2\"] = \"int2\";\n    PostgresTypes[\"int4\"] = \"int4\";\n    PostgresTypes[\"int4range\"] = \"int4range\";\n    PostgresTypes[\"int8\"] = \"int8\";\n    PostgresTypes[\"int8range\"] = \"int8range\";\n    PostgresTypes[\"json\"] = \"json\";\n    PostgresTypes[\"jsonb\"] = \"jsonb\";\n    PostgresTypes[\"money\"] = \"money\";\n    PostgresTypes[\"numeric\"] = \"numeric\";\n    PostgresTypes[\"oid\"] = \"oid\";\n    PostgresTypes[\"reltime\"] = \"reltime\";\n    PostgresTypes[\"text\"] = \"text\";\n    PostgresTypes[\"time\"] = \"time\";\n    PostgresTypes[\"timestamp\"] = \"timestamp\";\n    PostgresTypes[\"timestamptz\"] = \"timestamptz\";\n    PostgresTypes[\"timetz\"] = \"timetz\";\n    PostgresTypes[\"tsrange\"] = \"tsrange\";\n    PostgresTypes[\"tstzrange\"] = \"tstzrange\";\n})(PostgresTypes || (PostgresTypes = {}));\n/**\n * Takes an array of columns and an object of string values then converts each string value\n * to its mapped type.\n *\n * @param {{name: String, type: String}[]} columns\n * @param {Object} record\n * @param {Object} options The map of various options that can be applied to the mapper\n * @param {Array} options.skipTypes The array of types that should not be converted\n *\n * @example convertChangeData([{name: 'first_name', type: 'text'}, {name: 'age', type: 'int4'}], {first_name: 'Paul', age:'33'}, {})\n * //=>{ first_name: 'Paul', age: 33 }\n */\nexport const convertChangeData = (columns, record, options = {}) => {\n    var _a;\n    const skipTypes = (_a = options.skipTypes) !== null && _a !== void 0 ? _a : [];\n    if (!record) {\n        return {};\n    }\n    return Object.keys(record).reduce((acc, rec_key) => {\n        acc[rec_key] = convertColumn(rec_key, columns, record, skipTypes);\n        return acc;\n    }, {});\n};\n/**\n * Converts the value of an individual column.\n *\n * @param {String} columnName The column that you want to convert\n * @param {{name: String, type: String}[]} columns All of the columns\n * @param {Object} record The map of string values\n * @param {Array} skipTypes An array of types that should not be converted\n * @return {object} Useless information\n *\n * @example convertColumn('age', [{name: 'first_name', type: 'text'}, {name: 'age', type: 'int4'}], {first_name: 'Paul', age: '33'}, [])\n * //=> 33\n * @example convertColumn('age', [{name: 'first_name', type: 'text'}, {name: 'age', type: 'int4'}], {first_name: 'Paul', age: '33'}, ['int4'])\n * //=> \"33\"\n */\nexport const convertColumn = (columnName, columns, record, skipTypes) => {\n    const column = columns.find((x) => x.name === columnName);\n    const colType = column === null || column === void 0 ? void 0 : column.type;\n    const value = record[columnName];\n    if (colType && !skipTypes.includes(colType)) {\n        return convertCell(colType, value);\n    }\n    return noop(value);\n};\n/**\n * If the value of the cell is `null`, returns null.\n * Otherwise converts the string value to the correct type.\n * @param {String} type A postgres column type\n * @param {String} value The cell value\n *\n * @example convertCell('bool', 't')\n * //=> true\n * @example convertCell('int8', '10')\n * //=> 10\n * @example convertCell('_int4', '{1,2,3,4}')\n * //=> [1,2,3,4]\n */\nexport const convertCell = (type, value) => {\n    // if data type is an array\n    if (type.charAt(0) === '_') {\n        const dataType = type.slice(1, type.length);\n        return toArray(value, dataType);\n    }\n    // If not null, convert to correct type.\n    switch (type) {\n        case PostgresTypes.bool:\n            return toBoolean(value);\n        case PostgresTypes.float4:\n        case PostgresTypes.float8:\n        case PostgresTypes.int2:\n        case PostgresTypes.int4:\n        case PostgresTypes.int8:\n        case PostgresTypes.numeric:\n        case PostgresTypes.oid:\n            return toNumber(value);\n        case PostgresTypes.json:\n        case PostgresTypes.jsonb:\n            return toJson(value);\n        case PostgresTypes.timestamp:\n            return toTimestampString(value); // Format to be consistent with PostgREST\n        case PostgresTypes.abstime: // To allow users to cast it based on Timezone\n        case PostgresTypes.date: // To allow users to cast it based on Timezone\n        case PostgresTypes.daterange:\n        case PostgresTypes.int4range:\n        case PostgresTypes.int8range:\n        case PostgresTypes.money:\n        case PostgresTypes.reltime: // To allow users to cast it based on Timezone\n        case PostgresTypes.text:\n        case PostgresTypes.time: // To allow users to cast it based on Timezone\n        case PostgresTypes.timestamptz: // To allow users to cast it based on Timezone\n        case PostgresTypes.timetz: // To allow users to cast it based on Timezone\n        case PostgresTypes.tsrange:\n        case PostgresTypes.tstzrange:\n            return noop(value);\n        default:\n            // Return the value for remaining types\n            return noop(value);\n    }\n};\nconst noop = (value) => {\n    return value;\n};\nexport const toBoolean = (value) => {\n    switch (value) {\n        case 't':\n            return true;\n        case 'f':\n            return false;\n        default:\n            return value;\n    }\n};\nexport const toNumber = (value) => {\n    if (typeof value === 'string') {\n        const parsedValue = parseFloat(value);\n        if (!Number.isNaN(parsedValue)) {\n            return parsedValue;\n        }\n    }\n    return value;\n};\nexport const toJson = (value) => {\n    if (typeof value === 'string') {\n        try {\n            return JSON.parse(value);\n        }\n        catch (_a) {\n            return value;\n        }\n    }\n    return value;\n};\n/**\n * Converts a Postgres Array into a native JS array\n *\n * @example toArray('{}', 'int4')\n * //=> []\n * @example toArray('{\"[2021-01-01,2021-12-31)\",\"(2021-01-01,2021-12-32]\"}', 'daterange')\n * //=> ['[2021-01-01,2021-12-31)', '(2021-01-01,2021-12-32]']\n * @example toArray([1,2,3,4], 'int4')\n * //=> [1,2,3,4]\n */\nexport const toArray = (value, type) => {\n    if (typeof value !== 'string') {\n        return value;\n    }\n    const lastIdx = value.length - 1;\n    const closeBrace = value[lastIdx];\n    const openBrace = value[0];\n    // Confirm value is a Postgres array by checking curly brackets\n    if (openBrace === '{' && closeBrace === '}') {\n        let arr;\n        const valTrim = value.slice(1, lastIdx);\n        // TODO: find a better solution to separate Postgres array data\n        try {\n            arr = JSON.parse('[' + valTrim + ']');\n        }\n        catch (_) {\n            // WARNING: splitting on comma does not cover all edge cases\n            arr = valTrim ? valTrim.split(',') : [];\n        }\n        return arr.map((val) => convertCell(type, val));\n    }\n    return value;\n};\n/**\n * Fixes timestamp to be ISO-8601. Swaps the space between the date and time for a 'T'\n * See https://github.com/supabase/supabase/issues/18\n *\n * @example toTimestampString('2019-09-10 00:00:00')\n * //=> '2019-09-10T00:00:00'\n */\nexport const toTimestampString = (value) => {\n    if (typeof value === 'string') {\n        return value.replace(' ', 'T');\n    }\n    return value;\n};\nexport const httpEndpointURL = (socketUrl) => {\n    const wsUrl = new URL(socketUrl);\n    wsUrl.protocol = wsUrl.protocol.replace(/^ws/i, 'http');\n    wsUrl.pathname = wsUrl.pathname\n        .replace(/\\/+$/, '') // remove all trailing slashes\n        .replace(/\\/socket\\/websocket$/i, '') // remove the socket/websocket path\n        .replace(/\\/socket$/i, '') // remove the socket path\n        .replace(/\\/websocket$/i, ''); // remove the websocket path\n    if (wsUrl.pathname === '' || wsUrl.pathname === '/') {\n        wsUrl.pathname = '/api/broadcast';\n    }\n    else {\n        wsUrl.pathname = wsUrl.pathname + '/api/broadcast';\n    }\n    return wsUrl.href;\n};\n//# sourceMappingURL=transformers.js.map"],"names":[],"mappings":"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"}},
    {"offset": {"line": 184, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 189, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/node_modules/@supabase/realtime-js/dist/module/RealtimePresence.js"],"sourcesContent":["/*\n  This file draws heavily from https://github.com/phoenixframework/phoenix/blob/d344ec0a732ab4ee204215b31de69cf4be72e3bf/assets/js/phoenix/presence.js\n  License: https://github.com/phoenixframework/phoenix/blob/d344ec0a732ab4ee204215b31de69cf4be72e3bf/LICENSE.md\n*/\nexport var REALTIME_PRESENCE_LISTEN_EVENTS;\n(function (REALTIME_PRESENCE_LISTEN_EVENTS) {\n    REALTIME_PRESENCE_LISTEN_EVENTS[\"SYNC\"] = \"sync\";\n    REALTIME_PRESENCE_LISTEN_EVENTS[\"JOIN\"] = \"join\";\n    REALTIME_PRESENCE_LISTEN_EVENTS[\"LEAVE\"] = \"leave\";\n})(REALTIME_PRESENCE_LISTEN_EVENTS || (REALTIME_PRESENCE_LISTEN_EVENTS = {}));\nexport default class RealtimePresence {\n    /**\n     * Creates a Presence helper that keeps the local presence state in sync with the server.\n     *\n     * @param channel - The realtime channel to bind to.\n     * @param opts - Optional custom event names, e.g. `{ events: { state: 'state', diff: 'diff' } }`.\n     *\n     * @example\n     * ```ts\n     * const presence = new RealtimePresence(channel)\n     *\n     * channel.on('presence', ({ event, key }) => {\n     *   console.log(`Presence ${event} on ${key}`)\n     * })\n     * ```\n     */\n    constructor(channel, opts) {\n        this.channel = channel;\n        this.state = {};\n        this.pendingDiffs = [];\n        this.joinRef = null;\n        this.enabled = false;\n        this.caller = {\n            onJoin: () => { },\n            onLeave: () => { },\n            onSync: () => { },\n        };\n        const events = (opts === null || opts === void 0 ? void 0 : opts.events) || {\n            state: 'presence_state',\n            diff: 'presence_diff',\n        };\n        this.channel._on(events.state, {}, (newState) => {\n            const { onJoin, onLeave, onSync } = this.caller;\n            this.joinRef = this.channel._joinRef();\n            this.state = RealtimePresence.syncState(this.state, newState, onJoin, onLeave);\n            this.pendingDiffs.forEach((diff) => {\n                this.state = RealtimePresence.syncDiff(this.state, diff, onJoin, onLeave);\n            });\n            this.pendingDiffs = [];\n            onSync();\n        });\n        this.channel._on(events.diff, {}, (diff) => {\n            const { onJoin, onLeave, onSync } = this.caller;\n            if (this.inPendingSyncState()) {\n                this.pendingDiffs.push(diff);\n            }\n            else {\n                this.state = RealtimePresence.syncDiff(this.state, diff, onJoin, onLeave);\n                onSync();\n            }\n        });\n        this.onJoin((key, currentPresences, newPresences) => {\n            this.channel._trigger('presence', {\n                event: 'join',\n                key,\n                currentPresences,\n                newPresences,\n            });\n        });\n        this.onLeave((key, currentPresences, leftPresences) => {\n            this.channel._trigger('presence', {\n                event: 'leave',\n                key,\n                currentPresences,\n                leftPresences,\n            });\n        });\n        this.onSync(() => {\n            this.channel._trigger('presence', { event: 'sync' });\n        });\n    }\n    /**\n     * Used to sync the list of presences on the server with the\n     * client's state.\n     *\n     * An optional `onJoin` and `onLeave` callback can be provided to\n     * react to changes in the client's local presences across\n     * disconnects and reconnects with the server.\n     *\n     * @internal\n     */\n    static syncState(currentState, newState, onJoin, onLeave) {\n        const state = this.cloneDeep(currentState);\n        const transformedState = this.transformState(newState);\n        const joins = {};\n        const leaves = {};\n        this.map(state, (key, presences) => {\n            if (!transformedState[key]) {\n                leaves[key] = presences;\n            }\n        });\n        this.map(transformedState, (key, newPresences) => {\n            const currentPresences = state[key];\n            if (currentPresences) {\n                const newPresenceRefs = newPresences.map((m) => m.presence_ref);\n                const curPresenceRefs = currentPresences.map((m) => m.presence_ref);\n                const joinedPresences = newPresences.filter((m) => curPresenceRefs.indexOf(m.presence_ref) < 0);\n                const leftPresences = currentPresences.filter((m) => newPresenceRefs.indexOf(m.presence_ref) < 0);\n                if (joinedPresences.length > 0) {\n                    joins[key] = joinedPresences;\n                }\n                if (leftPresences.length > 0) {\n                    leaves[key] = leftPresences;\n                }\n            }\n            else {\n                joins[key] = newPresences;\n            }\n        });\n        return this.syncDiff(state, { joins, leaves }, onJoin, onLeave);\n    }\n    /**\n     * Used to sync a diff of presence join and leave events from the\n     * server, as they happen.\n     *\n     * Like `syncState`, `syncDiff` accepts optional `onJoin` and\n     * `onLeave` callbacks to react to a user joining or leaving from a\n     * device.\n     *\n     * @internal\n     */\n    static syncDiff(state, diff, onJoin, onLeave) {\n        const { joins, leaves } = {\n            joins: this.transformState(diff.joins),\n            leaves: this.transformState(diff.leaves),\n        };\n        if (!onJoin) {\n            onJoin = () => { };\n        }\n        if (!onLeave) {\n            onLeave = () => { };\n        }\n        this.map(joins, (key, newPresences) => {\n            var _a;\n            const currentPresences = (_a = state[key]) !== null && _a !== void 0 ? _a : [];\n            state[key] = this.cloneDeep(newPresences);\n            if (currentPresences.length > 0) {\n                const joinedPresenceRefs = state[key].map((m) => m.presence_ref);\n                const curPresences = currentPresences.filter((m) => joinedPresenceRefs.indexOf(m.presence_ref) < 0);\n                state[key].unshift(...curPresences);\n            }\n            onJoin(key, currentPresences, newPresences);\n        });\n        this.map(leaves, (key, leftPresences) => {\n            let currentPresences = state[key];\n            if (!currentPresences)\n                return;\n            const presenceRefsToRemove = leftPresences.map((m) => m.presence_ref);\n            currentPresences = currentPresences.filter((m) => presenceRefsToRemove.indexOf(m.presence_ref) < 0);\n            state[key] = currentPresences;\n            onLeave(key, currentPresences, leftPresences);\n            if (currentPresences.length === 0)\n                delete state[key];\n        });\n        return state;\n    }\n    /** @internal */\n    static map(obj, func) {\n        return Object.getOwnPropertyNames(obj).map((key) => func(key, obj[key]));\n    }\n    /**\n     * Remove 'metas' key\n     * Change 'phx_ref' to 'presence_ref'\n     * Remove 'phx_ref' and 'phx_ref_prev'\n     *\n     * @example\n     * // returns {\n     *  abc123: [\n     *    { presence_ref: '2', user_id: 1 },\n     *    { presence_ref: '3', user_id: 2 }\n     *  ]\n     * }\n     * RealtimePresence.transformState({\n     *  abc123: {\n     *    metas: [\n     *      { phx_ref: '2', phx_ref_prev: '1' user_id: 1 },\n     *      { phx_ref: '3', user_id: 2 }\n     *    ]\n     *  }\n     * })\n     *\n     * @internal\n     */\n    static transformState(state) {\n        state = this.cloneDeep(state);\n        return Object.getOwnPropertyNames(state).reduce((newState, key) => {\n            const presences = state[key];\n            if ('metas' in presences) {\n                newState[key] = presences.metas.map((presence) => {\n                    presence['presence_ref'] = presence['phx_ref'];\n                    delete presence['phx_ref'];\n                    delete presence['phx_ref_prev'];\n                    return presence;\n                });\n            }\n            else {\n                newState[key] = presences;\n            }\n            return newState;\n        }, {});\n    }\n    /** @internal */\n    static cloneDeep(obj) {\n        return JSON.parse(JSON.stringify(obj));\n    }\n    /** @internal */\n    onJoin(callback) {\n        this.caller.onJoin = callback;\n    }\n    /** @internal */\n    onLeave(callback) {\n        this.caller.onLeave = callback;\n    }\n    /** @internal */\n    onSync(callback) {\n        this.caller.onSync = callback;\n    }\n    /** @internal */\n    inPendingSyncState() {\n        return !this.joinRef || this.joinRef !== this.channel._joinRef();\n    }\n}\n//# sourceMappingURL=RealtimePresence.js.map"],"names":[],"mappings":"AAAA;;;AAGA;;;;AACO,IAAI;AACX,CAAC,SAAU,+BAA+B;IACtC,+BAA+B,CAAC,OAAO,GAAG;IAC1C,+BAA+B,CAAC,OAAO,GAAG;IAC1C,+BAA+B,CAAC,QAAQ,GAAG;AAC/C,CAAC,EAAE,mCAAmC,CAAC,kCAAkC,CAAC,CAAC;AAC5D,MAAM;IACjB;;;;;;;;;;;;;;KAcC,GACD,YAAY,OAAO,EAAE,IAAI,CAAE;QACvB,IAAI,CAAC,OAAO,GAAG;QACf,IAAI,CAAC,KAAK,GAAG,CAAC;QACd,IAAI,CAAC,YAAY,GAAG,EAAE;QACtB,IAAI,CAAC,OAAO,GAAG;QACf,IAAI,CAAC,OAAO,GAAG;QACf,IAAI,CAAC,MAAM,GAAG;YACV,QAAQ,KAAQ;YAChB,SAAS,KAAQ;YACjB,QAAQ,KAAQ;QACpB;QACA,MAAM,SAAS,CAAC,SAAS,QAAQ,SAAS,KAAK,IAAI,KAAK,IAAI,KAAK,MAAM,KAAK;YACxE,OAAO;YACP,MAAM;QACV;QACA,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,OAAO,KAAK,EAAE,CAAC,GAAG,CAAC;YAChC,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,MAAM,EAAE,GAAG,IAAI,CAAC,MAAM;YAC/C,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ;YACpC,IAAI,CAAC,KAAK,GAAG,iBAAiB,SAAS,CAAC,IAAI,CAAC,KAAK,EAAE,UAAU,QAAQ;YACtE,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;gBACvB,IAAI,CAAC,KAAK,GAAG,iBAAiB,QAAQ,CAAC,IAAI,CAAC,KAAK,EAAE,MAAM,QAAQ;YACrE;YACA,IAAI,CAAC,YAAY,GAAG,EAAE;YACtB;QACJ;QACA,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,OAAO,IAAI,EAAE,CAAC,GAAG,CAAC;YAC/B,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,MAAM,EAAE,GAAG,IAAI,CAAC,MAAM;YAC/C,IAAI,IAAI,CAAC,kBAAkB,IAAI;gBAC3B,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC;YAC3B,OACK;gBACD,IAAI,CAAC,KAAK,GAAG,iBAAiB,QAAQ,CAAC,IAAI,CAAC,KAAK,EAAE,MAAM,QAAQ;gBACjE;YACJ;QACJ;QACA,IAAI,CAAC,MAAM,CAAC,CAAC,KAAK,kBAAkB;YAChC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,YAAY;gBAC9B,OAAO;gBACP;gBACA;gBACA;YACJ;QACJ;QACA,IAAI,CAAC,OAAO,CAAC,CAAC,KAAK,kBAAkB;YACjC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,YAAY;gBAC9B,OAAO;gBACP;gBACA;gBACA;YACJ;QACJ;QACA,IAAI,CAAC,MAAM,CAAC;YACR,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,YAAY;gBAAE,OAAO;YAAO;QACtD;IACJ;IACA;;;;;;;;;KASC,GACD,OAAO,UAAU,YAAY,EAAE,QAAQ,EAAE,MAAM,EAAE,OAAO,EAAE;QACtD,MAAM,QAAQ,IAAI,CAAC,SAAS,CAAC;QAC7B,MAAM,mBAAmB,IAAI,CAAC,cAAc,CAAC;QAC7C,MAAM,QAAQ,CAAC;QACf,MAAM,SAAS,CAAC;QAChB,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK;YAClB,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE;gBACxB,MAAM,CAAC,IAAI,GAAG;YAClB;QACJ;QACA,IAAI,CAAC,GAAG,CAAC,kBAAkB,CAAC,KAAK;YAC7B,MAAM,mBAAmB,KAAK,CAAC,IAAI;YACnC,IAAI,kBAAkB;gBAClB,MAAM,kBAAkB,aAAa,GAAG,CAAC,CAAC,IAAM,EAAE,YAAY;gBAC9D,MAAM,kBAAkB,iBAAiB,GAAG,CAAC,CAAC,IAAM,EAAE,YAAY;gBAClE,MAAM,kBAAkB,aAAa,MAAM,CAAC,CAAC,IAAM,gBAAgB,OAAO,CAAC,EAAE,YAAY,IAAI;gBAC7F,MAAM,gBAAgB,iBAAiB,MAAM,CAAC,CAAC,IAAM,gBAAgB,OAAO,CAAC,EAAE,YAAY,IAAI;gBAC/F,IAAI,gBAAgB,MAAM,GAAG,GAAG;oBAC5B,KAAK,CAAC,IAAI,GAAG;gBACjB;gBACA,IAAI,cAAc,MAAM,GAAG,GAAG;oBAC1B,MAAM,CAAC,IAAI,GAAG;gBAClB;YACJ,OACK;gBACD,KAAK,CAAC,IAAI,GAAG;YACjB;QACJ;QACA,OAAO,IAAI,CAAC,QAAQ,CAAC,OAAO;YAAE;YAAO;QAAO,GAAG,QAAQ;IAC3D;IACA;;;;;;;;;KASC,GACD,OAAO,SAAS,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE;QAC1C,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG;YACtB,OAAO,IAAI,CAAC,cAAc,CAAC,KAAK,KAAK;YACrC,QAAQ,IAAI,CAAC,cAAc,CAAC,KAAK,MAAM;QAC3C;QACA,IAAI,CAAC,QAAQ;YACT,SAAS,KAAQ;QACrB;QACA,IAAI,CAAC,SAAS;YACV,UAAU,KAAQ;QACtB;QACA,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK;YAClB,IAAI;YACJ,MAAM,mBAAmB,CAAC,KAAK,KAAK,CAAC,IAAI,MAAM,QAAQ,OAAO,KAAK,IAAI,KAAK,EAAE;YAC9E,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC;YAC5B,IAAI,iBAAiB,MAAM,GAAG,GAAG;gBAC7B,MAAM,qBAAqB,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,IAAM,EAAE,YAAY;gBAC/D,MAAM,eAAe,iBAAiB,MAAM,CAAC,CAAC,IAAM,mBAAmB,OAAO,CAAC,EAAE,YAAY,IAAI;gBACjG,KAAK,CAAC,IAAI,CAAC,OAAO,IAAI;YAC1B;YACA,OAAO,KAAK,kBAAkB;QAClC;QACA,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,KAAK;YACnB,IAAI,mBAAmB,KAAK,CAAC,IAAI;YACjC,IAAI,CAAC,kBACD;YACJ,MAAM,uBAAuB,cAAc,GAAG,CAAC,CAAC,IAAM,EAAE,YAAY;YACpE,mBAAmB,iBAAiB,MAAM,CAAC,CAAC,IAAM,qBAAqB,OAAO,CAAC,EAAE,YAAY,IAAI;YACjG,KAAK,CAAC,IAAI,GAAG;YACb,QAAQ,KAAK,kBAAkB;YAC/B,IAAI,iBAAiB,MAAM,KAAK,GAC5B,OAAO,KAAK,CAAC,IAAI;QACzB;QACA,OAAO;IACX;IACA,cAAc,GACd,OAAO,IAAI,GAAG,EAAE,IAAI,EAAE;QAClB,OAAO,OAAO,mBAAmB,CAAC,KAAK,GAAG,CAAC,CAAC,MAAQ,KAAK,KAAK,GAAG,CAAC,IAAI;IAC1E;IACA;;;;;;;;;;;;;;;;;;;;;;KAsBC,GACD,OAAO,eAAe,KAAK,EAAE;QACzB,QAAQ,IAAI,CAAC,SAAS,CAAC;QACvB,OAAO,OAAO,mBAAmB,CAAC,OAAO,MAAM,CAAC,CAAC,UAAU;YACvD,MAAM,YAAY,KAAK,CAAC,IAAI;YAC5B,IAAI,WAAW,WAAW;gBACtB,QAAQ,CAAC,IAAI,GAAG,UAAU,KAAK,CAAC,GAAG,CAAC,CAAC;oBACjC,QAAQ,CAAC,eAAe,GAAG,QAAQ,CAAC,UAAU;oBAC9C,OAAO,QAAQ,CAAC,UAAU;oBAC1B,OAAO,QAAQ,CAAC,eAAe;oBAC/B,OAAO;gBACX;YACJ,OACK;gBACD,QAAQ,CAAC,IAAI,GAAG;YACpB;YACA,OAAO;QACX,GAAG,CAAC;IACR;IACA,cAAc,GACd,OAAO,UAAU,GAAG,EAAE;QAClB,OAAO,KAAK,KAAK,CAAC,KAAK,SAAS,CAAC;IACrC;IACA,cAAc,GACd,OAAO,QAAQ,EAAE;QACb,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG;IACzB;IACA,cAAc,GACd,QAAQ,QAAQ,EAAE;QACd,IAAI,CAAC,MAAM,CAAC,OAAO,GAAG;IAC1B;IACA,cAAc,GACd,OAAO,QAAQ,EAAE;QACb,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG;IACzB;IACA,cAAc,GACd,qBAAqB;QACjB,OAAO,CAAC,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,KAAK,IAAI,CAAC,OAAO,CAAC,QAAQ;IAClE;AACJ,EACA,4CAA4C"}},
    {"offset": {"line": 414, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 419, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/node_modules/@supabase/realtime-js/dist/module/lib/timer.js"],"sourcesContent":["/**\n * Creates a timer that accepts a `timerCalc` function to perform calculated timeout retries, such as exponential backoff.\n *\n * @example\n *    let reconnectTimer = new Timer(() => this.connect(), function(tries){\n *      return [1000, 5000, 10000][tries - 1] || 10000\n *    })\n *    reconnectTimer.scheduleTimeout() // fires after 1000\n *    reconnectTimer.scheduleTimeout() // fires after 5000\n *    reconnectTimer.reset()\n *    reconnectTimer.scheduleTimeout() // fires after 1000\n */\nexport default class Timer {\n    constructor(callback, timerCalc) {\n        this.callback = callback;\n        this.timerCalc = timerCalc;\n        this.timer = undefined;\n        this.tries = 0;\n        this.callback = callback;\n        this.timerCalc = timerCalc;\n    }\n    reset() {\n        this.tries = 0;\n        clearTimeout(this.timer);\n        this.timer = undefined;\n    }\n    // Cancels any previous scheduleTimeout and schedules callback\n    scheduleTimeout() {\n        clearTimeout(this.timer);\n        this.timer = setTimeout(() => {\n            this.tries = this.tries + 1;\n            this.callback();\n        }, this.timerCalc(this.tries + 1));\n    }\n}\n//# sourceMappingURL=timer.js.map"],"names":[],"mappings":"AAAA;;;;;;;;;;;CAWC;;;AACc,MAAM;IACjB,YAAY,QAAQ,EAAE,SAAS,CAAE;QAC7B,IAAI,CAAC,QAAQ,GAAG;QAChB,IAAI,CAAC,SAAS,GAAG;QACjB,IAAI,CAAC,KAAK,GAAG;QACb,IAAI,CAAC,KAAK,GAAG;QACb,IAAI,CAAC,QAAQ,GAAG;QAChB,IAAI,CAAC,SAAS,GAAG;IACrB;IACA,QAAQ;QACJ,IAAI,CAAC,KAAK,GAAG;QACb,aAAa,IAAI,CAAC,KAAK;QACvB,IAAI,CAAC,KAAK,GAAG;IACjB;IACA,8DAA8D;IAC9D,kBAAkB;QACd,aAAa,IAAI,CAAC,KAAK;QACvB,IAAI,CAAC,KAAK,GAAG,WAAW;YACpB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,GAAG;YAC1B,IAAI,CAAC,QAAQ;QACjB,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,GAAG;IACnC;AACJ,EACA,iCAAiC"}},
    {"offset": {"line": 456, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 461, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/node_modules/@supabase/realtime-js/dist/module/lib/version.js"],"sourcesContent":["// Generated automatically during releases by scripts/update-version-files.ts\n// This file provides runtime access to the package version for:\n// - HTTP request headers (e.g., X-Client-Info header for API requests)\n// - Debugging and support (identifying which version is running)\n// - Telemetry and logging (version reporting in errors/analytics)\n// - Ensuring build artifacts match the published package version\nexport const version = '2.90.1';\n//# sourceMappingURL=version.js.map"],"names":[],"mappings":"AAAA,6EAA6E;AAC7E,gEAAgE;AAChE,uEAAuE;AACvE,iEAAiE;AACjE,kEAAkE;AAClE,iEAAiE;;;;AAC1D,MAAM,UAAU,UACvB,mCAAmC"}},
    {"offset": {"line": 471, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 476, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/node_modules/@supabase/realtime-js/dist/module/lib/constants.js"],"sourcesContent":["import { version } from './version';\nexport const DEFAULT_VERSION = `realtime-js/${version}`;\nexport const VSN_1_0_0 = '1.0.0';\nexport const VSN_2_0_0 = '2.0.0';\nexport const DEFAULT_VSN = VSN_1_0_0;\nexport const VERSION = version;\nexport const DEFAULT_TIMEOUT = 10000;\nexport const WS_CLOSE_NORMAL = 1000;\nexport const MAX_PUSH_BUFFER_SIZE = 100;\nexport var SOCKET_STATES;\n(function (SOCKET_STATES) {\n    SOCKET_STATES[SOCKET_STATES[\"connecting\"] = 0] = \"connecting\";\n    SOCKET_STATES[SOCKET_STATES[\"open\"] = 1] = \"open\";\n    SOCKET_STATES[SOCKET_STATES[\"closing\"] = 2] = \"closing\";\n    SOCKET_STATES[SOCKET_STATES[\"closed\"] = 3] = \"closed\";\n})(SOCKET_STATES || (SOCKET_STATES = {}));\nexport var CHANNEL_STATES;\n(function (CHANNEL_STATES) {\n    CHANNEL_STATES[\"closed\"] = \"closed\";\n    CHANNEL_STATES[\"errored\"] = \"errored\";\n    CHANNEL_STATES[\"joined\"] = \"joined\";\n    CHANNEL_STATES[\"joining\"] = \"joining\";\n    CHANNEL_STATES[\"leaving\"] = \"leaving\";\n})(CHANNEL_STATES || (CHANNEL_STATES = {}));\nexport var CHANNEL_EVENTS;\n(function (CHANNEL_EVENTS) {\n    CHANNEL_EVENTS[\"close\"] = \"phx_close\";\n    CHANNEL_EVENTS[\"error\"] = \"phx_error\";\n    CHANNEL_EVENTS[\"join\"] = \"phx_join\";\n    CHANNEL_EVENTS[\"reply\"] = \"phx_reply\";\n    CHANNEL_EVENTS[\"leave\"] = \"phx_leave\";\n    CHANNEL_EVENTS[\"access_token\"] = \"access_token\";\n})(CHANNEL_EVENTS || (CHANNEL_EVENTS = {}));\nexport var TRANSPORTS;\n(function (TRANSPORTS) {\n    TRANSPORTS[\"websocket\"] = \"websocket\";\n})(TRANSPORTS || (TRANSPORTS = {}));\nexport var CONNECTION_STATE;\n(function (CONNECTION_STATE) {\n    CONNECTION_STATE[\"Connecting\"] = \"connecting\";\n    CONNECTION_STATE[\"Open\"] = \"open\";\n    CONNECTION_STATE[\"Closing\"] = \"closing\";\n    CONNECTION_STATE[\"Closed\"] = \"closed\";\n})(CONNECTION_STATE || (CONNECTION_STATE = {}));\n//# sourceMappingURL=constants.js.map"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AACO,MAAM,kBAAkB,CAAC,YAAY,iMAAU,CAAC;AAChD,MAAM,YAAY;AAClB,MAAM,YAAY;AAClB,MAAM,cAAc;AACpB,MAAM;AACN,MAAM,kBAAkB;AACxB,MAAM,kBAAkB;AACxB,MAAM,uBAAuB;AAC7B,IAAI;AACX,CAAC,SAAU,aAAa;IACpB,aAAa,CAAC,aAAa,CAAC,aAAa,GAAG,EAAE,GAAG;IACjD,aAAa,CAAC,aAAa,CAAC,OAAO,GAAG,EAAE,GAAG;IAC3C,aAAa,CAAC,aAAa,CAAC,UAAU,GAAG,EAAE,GAAG;IAC9C,aAAa,CAAC,aAAa,CAAC,SAAS,GAAG,EAAE,GAAG;AACjD,CAAC,EAAE,iBAAiB,CAAC,gBAAgB,CAAC,CAAC;AAChC,IAAI;AACX,CAAC,SAAU,cAAc;IACrB,cAAc,CAAC,SAAS,GAAG;IAC3B,cAAc,CAAC,UAAU,GAAG;IAC5B,cAAc,CAAC,SAAS,GAAG;IAC3B,cAAc,CAAC,UAAU,GAAG;IAC5B,cAAc,CAAC,UAAU,GAAG;AAChC,CAAC,EAAE,kBAAkB,CAAC,iBAAiB,CAAC,CAAC;AAClC,IAAI;AACX,CAAC,SAAU,cAAc;IACrB,cAAc,CAAC,QAAQ,GAAG;IAC1B,cAAc,CAAC,QAAQ,GAAG;IAC1B,cAAc,CAAC,OAAO,GAAG;IACzB,cAAc,CAAC,QAAQ,GAAG;IAC1B,cAAc,CAAC,QAAQ,GAAG;IAC1B,cAAc,CAAC,eAAe,GAAG;AACrC,CAAC,EAAE,kBAAkB,CAAC,iBAAiB,CAAC,CAAC;AAClC,IAAI;AACX,CAAC,SAAU,UAAU;IACjB,UAAU,CAAC,YAAY,GAAG;AAC9B,CAAC,EAAE,cAAc,CAAC,aAAa,CAAC,CAAC;AAC1B,IAAI;AACX,CAAC,SAAU,gBAAgB;IACvB,gBAAgB,CAAC,aAAa,GAAG;IACjC,gBAAgB,CAAC,OAAO,GAAG;IAC3B,gBAAgB,CAAC,UAAU,GAAG;IAC9B,gBAAgB,CAAC,SAAS,GAAG;AACjC,CAAC,EAAE,oBAAoB,CAAC,mBAAmB,CAAC,CAAC,IAC7C,qCAAqC"}},
    {"offset": {"line": 537, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 542, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/node_modules/@supabase/realtime-js/dist/module/lib/push.js"],"sourcesContent":["import { DEFAULT_TIMEOUT } from '../lib/constants';\nexport default class Push {\n    /**\n     * Initializes the Push\n     *\n     * @param channel The Channel\n     * @param event The event, for example `\"phx_join\"`\n     * @param payload The payload, for example `{user_id: 123}`\n     * @param timeout The push timeout in milliseconds\n     */\n    constructor(channel, event, payload = {}, timeout = DEFAULT_TIMEOUT) {\n        this.channel = channel;\n        this.event = event;\n        this.payload = payload;\n        this.timeout = timeout;\n        this.sent = false;\n        this.timeoutTimer = undefined;\n        this.ref = '';\n        this.receivedResp = null;\n        this.recHooks = [];\n        this.refEvent = null;\n    }\n    resend(timeout) {\n        this.timeout = timeout;\n        this._cancelRefEvent();\n        this.ref = '';\n        this.refEvent = null;\n        this.receivedResp = null;\n        this.sent = false;\n        this.send();\n    }\n    send() {\n        if (this._hasReceived('timeout')) {\n            return;\n        }\n        this.startTimeout();\n        this.sent = true;\n        this.channel.socket.push({\n            topic: this.channel.topic,\n            event: this.event,\n            payload: this.payload,\n            ref: this.ref,\n            join_ref: this.channel._joinRef(),\n        });\n    }\n    updatePayload(payload) {\n        this.payload = Object.assign(Object.assign({}, this.payload), payload);\n    }\n    receive(status, callback) {\n        var _a;\n        if (this._hasReceived(status)) {\n            callback((_a = this.receivedResp) === null || _a === void 0 ? void 0 : _a.response);\n        }\n        this.recHooks.push({ status, callback });\n        return this;\n    }\n    startTimeout() {\n        if (this.timeoutTimer) {\n            return;\n        }\n        this.ref = this.channel.socket._makeRef();\n        this.refEvent = this.channel._replyEventName(this.ref);\n        const callback = (payload) => {\n            this._cancelRefEvent();\n            this._cancelTimeout();\n            this.receivedResp = payload;\n            this._matchReceive(payload);\n        };\n        this.channel._on(this.refEvent, {}, callback);\n        this.timeoutTimer = setTimeout(() => {\n            this.trigger('timeout', {});\n        }, this.timeout);\n    }\n    trigger(status, response) {\n        if (this.refEvent)\n            this.channel._trigger(this.refEvent, { status, response });\n    }\n    destroy() {\n        this._cancelRefEvent();\n        this._cancelTimeout();\n    }\n    _cancelRefEvent() {\n        if (!this.refEvent) {\n            return;\n        }\n        this.channel._off(this.refEvent, {});\n    }\n    _cancelTimeout() {\n        clearTimeout(this.timeoutTimer);\n        this.timeoutTimer = undefined;\n    }\n    _matchReceive({ status, response }) {\n        this.recHooks.filter((h) => h.status === status).forEach((h) => h.callback(response));\n    }\n    _hasReceived(status) {\n        return this.receivedResp && this.receivedResp.status === status;\n    }\n}\n//# sourceMappingURL=push.js.map"],"names":[],"mappings":"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"}},
    {"offset": {"line": 649, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 654, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/node_modules/@supabase/realtime-js/dist/module/RealtimeChannel.js"],"sourcesContent":["import { CHANNEL_EVENTS, CHANNEL_STATES, MAX_PUSH_BUFFER_SIZE } from './lib/constants';\nimport Push from './lib/push';\nimport Timer from './lib/timer';\nimport RealtimePresence from './RealtimePresence';\nimport * as Transformers from './lib/transformers';\nimport { httpEndpointURL } from './lib/transformers';\nexport var REALTIME_POSTGRES_CHANGES_LISTEN_EVENT;\n(function (REALTIME_POSTGRES_CHANGES_LISTEN_EVENT) {\n    REALTIME_POSTGRES_CHANGES_LISTEN_EVENT[\"ALL\"] = \"*\";\n    REALTIME_POSTGRES_CHANGES_LISTEN_EVENT[\"INSERT\"] = \"INSERT\";\n    REALTIME_POSTGRES_CHANGES_LISTEN_EVENT[\"UPDATE\"] = \"UPDATE\";\n    REALTIME_POSTGRES_CHANGES_LISTEN_EVENT[\"DELETE\"] = \"DELETE\";\n})(REALTIME_POSTGRES_CHANGES_LISTEN_EVENT || (REALTIME_POSTGRES_CHANGES_LISTEN_EVENT = {}));\nexport var REALTIME_LISTEN_TYPES;\n(function (REALTIME_LISTEN_TYPES) {\n    REALTIME_LISTEN_TYPES[\"BROADCAST\"] = \"broadcast\";\n    REALTIME_LISTEN_TYPES[\"PRESENCE\"] = \"presence\";\n    REALTIME_LISTEN_TYPES[\"POSTGRES_CHANGES\"] = \"postgres_changes\";\n    REALTIME_LISTEN_TYPES[\"SYSTEM\"] = \"system\";\n})(REALTIME_LISTEN_TYPES || (REALTIME_LISTEN_TYPES = {}));\nexport var REALTIME_SUBSCRIBE_STATES;\n(function (REALTIME_SUBSCRIBE_STATES) {\n    REALTIME_SUBSCRIBE_STATES[\"SUBSCRIBED\"] = \"SUBSCRIBED\";\n    REALTIME_SUBSCRIBE_STATES[\"TIMED_OUT\"] = \"TIMED_OUT\";\n    REALTIME_SUBSCRIBE_STATES[\"CLOSED\"] = \"CLOSED\";\n    REALTIME_SUBSCRIBE_STATES[\"CHANNEL_ERROR\"] = \"CHANNEL_ERROR\";\n})(REALTIME_SUBSCRIBE_STATES || (REALTIME_SUBSCRIBE_STATES = {}));\nexport const REALTIME_CHANNEL_STATES = CHANNEL_STATES;\n/** A channel is the basic building block of Realtime\n * and narrows the scope of data flow to subscribed clients.\n * You can think of a channel as a chatroom where participants are able to see who's online\n * and send and receive messages.\n */\nexport default class RealtimeChannel {\n    /**\n     * Creates a channel that can broadcast messages, sync presence, and listen to Postgres changes.\n     *\n     * The topic determines which realtime stream you are subscribing to. Config options let you\n     * enable acknowledgement for broadcasts, presence tracking, or private channels.\n     *\n     * @example\n     * ```ts\n     * import RealtimeClient from '@supabase/realtime-js'\n     *\n     * const client = new RealtimeClient('https://xyzcompany.supabase.co/realtime/v1', {\n     *   params: { apikey: 'public-anon-key' },\n     * })\n     * const channel = new RealtimeChannel('realtime:public:messages', { config: {} }, client)\n     * ```\n     */\n    constructor(\n    /** Topic name can be any string. */\n    topic, params = { config: {} }, socket) {\n        var _a, _b;\n        this.topic = topic;\n        this.params = params;\n        this.socket = socket;\n        this.bindings = {};\n        this.state = CHANNEL_STATES.closed;\n        this.joinedOnce = false;\n        this.pushBuffer = [];\n        this.subTopic = topic.replace(/^realtime:/i, '');\n        this.params.config = Object.assign({\n            broadcast: { ack: false, self: false },\n            presence: { key: '', enabled: false },\n            private: false,\n        }, params.config);\n        this.timeout = this.socket.timeout;\n        this.joinPush = new Push(this, CHANNEL_EVENTS.join, this.params, this.timeout);\n        this.rejoinTimer = new Timer(() => this._rejoinUntilConnected(), this.socket.reconnectAfterMs);\n        this.joinPush.receive('ok', () => {\n            this.state = CHANNEL_STATES.joined;\n            this.rejoinTimer.reset();\n            this.pushBuffer.forEach((pushEvent) => pushEvent.send());\n            this.pushBuffer = [];\n        });\n        this._onClose(() => {\n            this.rejoinTimer.reset();\n            this.socket.log('channel', `close ${this.topic} ${this._joinRef()}`);\n            this.state = CHANNEL_STATES.closed;\n            this.socket._remove(this);\n        });\n        this._onError((reason) => {\n            if (this._isLeaving() || this._isClosed()) {\n                return;\n            }\n            this.socket.log('channel', `error ${this.topic}`, reason);\n            this.state = CHANNEL_STATES.errored;\n            this.rejoinTimer.scheduleTimeout();\n        });\n        this.joinPush.receive('timeout', () => {\n            if (!this._isJoining()) {\n                return;\n            }\n            this.socket.log('channel', `timeout ${this.topic}`, this.joinPush.timeout);\n            this.state = CHANNEL_STATES.errored;\n            this.rejoinTimer.scheduleTimeout();\n        });\n        this.joinPush.receive('error', (reason) => {\n            if (this._isLeaving() || this._isClosed()) {\n                return;\n            }\n            this.socket.log('channel', `error ${this.topic}`, reason);\n            this.state = CHANNEL_STATES.errored;\n            this.rejoinTimer.scheduleTimeout();\n        });\n        this._on(CHANNEL_EVENTS.reply, {}, (payload, ref) => {\n            this._trigger(this._replyEventName(ref), payload);\n        });\n        this.presence = new RealtimePresence(this);\n        this.broadcastEndpointURL = httpEndpointURL(this.socket.endPoint);\n        this.private = this.params.config.private || false;\n        if (!this.private && ((_b = (_a = this.params.config) === null || _a === void 0 ? void 0 : _a.broadcast) === null || _b === void 0 ? void 0 : _b.replay)) {\n            throw `tried to use replay on public channel '${this.topic}'. It must be a private channel.`;\n        }\n    }\n    /** Subscribe registers your client with the server */\n    subscribe(callback, timeout = this.timeout) {\n        var _a, _b, _c;\n        if (!this.socket.isConnected()) {\n            this.socket.connect();\n        }\n        if (this.state == CHANNEL_STATES.closed) {\n            const { config: { broadcast, presence, private: isPrivate }, } = this.params;\n            const postgres_changes = (_b = (_a = this.bindings.postgres_changes) === null || _a === void 0 ? void 0 : _a.map((r) => r.filter)) !== null && _b !== void 0 ? _b : [];\n            const presence_enabled = (!!this.bindings[REALTIME_LISTEN_TYPES.PRESENCE] &&\n                this.bindings[REALTIME_LISTEN_TYPES.PRESENCE].length > 0) ||\n                ((_c = this.params.config.presence) === null || _c === void 0 ? void 0 : _c.enabled) === true;\n            const accessTokenPayload = {};\n            const config = {\n                broadcast,\n                presence: Object.assign(Object.assign({}, presence), { enabled: presence_enabled }),\n                postgres_changes,\n                private: isPrivate,\n            };\n            if (this.socket.accessTokenValue) {\n                accessTokenPayload.access_token = this.socket.accessTokenValue;\n            }\n            this._onError((e) => callback === null || callback === void 0 ? void 0 : callback(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR, e));\n            this._onClose(() => callback === null || callback === void 0 ? void 0 : callback(REALTIME_SUBSCRIBE_STATES.CLOSED));\n            this.updateJoinPayload(Object.assign({ config }, accessTokenPayload));\n            this.joinedOnce = true;\n            this._rejoin(timeout);\n            this.joinPush\n                .receive('ok', async ({ postgres_changes }) => {\n                var _a;\n                // Only refresh auth if using callback-based tokens\n                if (!this.socket._isManualToken()) {\n                    this.socket.setAuth();\n                }\n                if (postgres_changes === undefined) {\n                    callback === null || callback === void 0 ? void 0 : callback(REALTIME_SUBSCRIBE_STATES.SUBSCRIBED);\n                    return;\n                }\n                else {\n                    const clientPostgresBindings = this.bindings.postgres_changes;\n                    const bindingsLen = (_a = clientPostgresBindings === null || clientPostgresBindings === void 0 ? void 0 : clientPostgresBindings.length) !== null && _a !== void 0 ? _a : 0;\n                    const newPostgresBindings = [];\n                    for (let i = 0; i < bindingsLen; i++) {\n                        const clientPostgresBinding = clientPostgresBindings[i];\n                        const { filter: { event, schema, table, filter }, } = clientPostgresBinding;\n                        const serverPostgresFilter = postgres_changes && postgres_changes[i];\n                        if (serverPostgresFilter &&\n                            serverPostgresFilter.event === event &&\n                            RealtimeChannel.isFilterValueEqual(serverPostgresFilter.schema, schema) &&\n                            RealtimeChannel.isFilterValueEqual(serverPostgresFilter.table, table) &&\n                            RealtimeChannel.isFilterValueEqual(serverPostgresFilter.filter, filter)) {\n                            newPostgresBindings.push(Object.assign(Object.assign({}, clientPostgresBinding), { id: serverPostgresFilter.id }));\n                        }\n                        else {\n                            this.unsubscribe();\n                            this.state = CHANNEL_STATES.errored;\n                            callback === null || callback === void 0 ? void 0 : callback(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR, new Error('mismatch between server and client bindings for postgres changes'));\n                            return;\n                        }\n                    }\n                    this.bindings.postgres_changes = newPostgresBindings;\n                    callback && callback(REALTIME_SUBSCRIBE_STATES.SUBSCRIBED);\n                    return;\n                }\n            })\n                .receive('error', (error) => {\n                this.state = CHANNEL_STATES.errored;\n                callback === null || callback === void 0 ? void 0 : callback(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR, new Error(JSON.stringify(Object.values(error).join(', ') || 'error')));\n                return;\n            })\n                .receive('timeout', () => {\n                callback === null || callback === void 0 ? void 0 : callback(REALTIME_SUBSCRIBE_STATES.TIMED_OUT);\n                return;\n            });\n        }\n        return this;\n    }\n    /**\n     * Returns the current presence state for this channel.\n     *\n     * The shape is a map keyed by presence key (for example a user id) where each entry contains the\n     * tracked metadata for that user.\n     */\n    presenceState() {\n        return this.presence.state;\n    }\n    /**\n     * Sends the supplied payload to the presence tracker so other subscribers can see that this\n     * client is online. Use `untrack` to stop broadcasting presence for the same key.\n     */\n    async track(payload, opts = {}) {\n        return await this.send({\n            type: 'presence',\n            event: 'track',\n            payload,\n        }, opts.timeout || this.timeout);\n    }\n    /**\n     * Removes the current presence state for this client.\n     */\n    async untrack(opts = {}) {\n        return await this.send({\n            type: 'presence',\n            event: 'untrack',\n        }, opts);\n    }\n    on(type, filter, callback) {\n        if (this.state === CHANNEL_STATES.joined && type === REALTIME_LISTEN_TYPES.PRESENCE) {\n            this.socket.log('channel', `resubscribe to ${this.topic} due to change in presence callbacks on joined channel`);\n            this.unsubscribe().then(async () => await this.subscribe());\n        }\n        return this._on(type, filter, callback);\n    }\n    /**\n     * Sends a broadcast message explicitly via REST API.\n     *\n     * This method always uses the REST API endpoint regardless of WebSocket connection state.\n     * Useful when you want to guarantee REST delivery or when gradually migrating from implicit REST fallback.\n     *\n     * @param event The name of the broadcast event\n     * @param payload Payload to be sent (required)\n     * @param opts Options including timeout\n     * @returns Promise resolving to object with success status, and error details if failed\n     */\n    async httpSend(event, payload, opts = {}) {\n        var _a;\n        if (payload === undefined || payload === null) {\n            return Promise.reject('Payload is required for httpSend()');\n        }\n        const headers = {\n            apikey: this.socket.apiKey ? this.socket.apiKey : '',\n            'Content-Type': 'application/json',\n        };\n        if (this.socket.accessTokenValue) {\n            headers['Authorization'] = `Bearer ${this.socket.accessTokenValue}`;\n        }\n        const options = {\n            method: 'POST',\n            headers,\n            body: JSON.stringify({\n                messages: [\n                    {\n                        topic: this.subTopic,\n                        event,\n                        payload: payload,\n                        private: this.private,\n                    },\n                ],\n            }),\n        };\n        const response = await this._fetchWithTimeout(this.broadcastEndpointURL, options, (_a = opts.timeout) !== null && _a !== void 0 ? _a : this.timeout);\n        if (response.status === 202) {\n            return { success: true };\n        }\n        let errorMessage = response.statusText;\n        try {\n            const errorBody = await response.json();\n            errorMessage = errorBody.error || errorBody.message || errorMessage;\n        }\n        catch (_b) { }\n        return Promise.reject(new Error(errorMessage));\n    }\n    /**\n     * Sends a message into the channel.\n     *\n     * @param args Arguments to send to channel\n     * @param args.type The type of event to send\n     * @param args.event The name of the event being sent\n     * @param args.payload Payload to be sent\n     * @param opts Options to be used during the send process\n     */\n    async send(args, opts = {}) {\n        var _a, _b;\n        if (!this._canPush() && args.type === 'broadcast') {\n            console.warn('Realtime send() is automatically falling back to REST API. ' +\n                'This behavior will be deprecated in the future. ' +\n                'Please use httpSend() explicitly for REST delivery.');\n            const { event, payload: endpoint_payload } = args;\n            const headers = {\n                apikey: this.socket.apiKey ? this.socket.apiKey : '',\n                'Content-Type': 'application/json',\n            };\n            if (this.socket.accessTokenValue) {\n                headers['Authorization'] = `Bearer ${this.socket.accessTokenValue}`;\n            }\n            const options = {\n                method: 'POST',\n                headers,\n                body: JSON.stringify({\n                    messages: [\n                        {\n                            topic: this.subTopic,\n                            event,\n                            payload: endpoint_payload,\n                            private: this.private,\n                        },\n                    ],\n                }),\n            };\n            try {\n                const response = await this._fetchWithTimeout(this.broadcastEndpointURL, options, (_a = opts.timeout) !== null && _a !== void 0 ? _a : this.timeout);\n                await ((_b = response.body) === null || _b === void 0 ? void 0 : _b.cancel());\n                return response.ok ? 'ok' : 'error';\n            }\n            catch (error) {\n                if (error.name === 'AbortError') {\n                    return 'timed out';\n                }\n                else {\n                    return 'error';\n                }\n            }\n        }\n        else {\n            return new Promise((resolve) => {\n                var _a, _b, _c;\n                const push = this._push(args.type, args, opts.timeout || this.timeout);\n                if (args.type === 'broadcast' && !((_c = (_b = (_a = this.params) === null || _a === void 0 ? void 0 : _a.config) === null || _b === void 0 ? void 0 : _b.broadcast) === null || _c === void 0 ? void 0 : _c.ack)) {\n                    resolve('ok');\n                }\n                push.receive('ok', () => resolve('ok'));\n                push.receive('error', () => resolve('error'));\n                push.receive('timeout', () => resolve('timed out'));\n            });\n        }\n    }\n    /**\n     * Updates the payload that will be sent the next time the channel joins (reconnects).\n     * Useful for rotating access tokens or updating config without re-creating the channel.\n     */\n    updateJoinPayload(payload) {\n        this.joinPush.updatePayload(payload);\n    }\n    /**\n     * Leaves the channel.\n     *\n     * Unsubscribes from server events, and instructs channel to terminate on server.\n     * Triggers onClose() hooks.\n     *\n     * To receive leave acknowledgements, use the a `receive` hook to bind to the server ack, ie:\n     * channel.unsubscribe().receive(\"ok\", () => alert(\"left!\") )\n     */\n    unsubscribe(timeout = this.timeout) {\n        this.state = CHANNEL_STATES.leaving;\n        const onClose = () => {\n            this.socket.log('channel', `leave ${this.topic}`);\n            this._trigger(CHANNEL_EVENTS.close, 'leave', this._joinRef());\n        };\n        this.joinPush.destroy();\n        let leavePush = null;\n        return new Promise((resolve) => {\n            leavePush = new Push(this, CHANNEL_EVENTS.leave, {}, timeout);\n            leavePush\n                .receive('ok', () => {\n                onClose();\n                resolve('ok');\n            })\n                .receive('timeout', () => {\n                onClose();\n                resolve('timed out');\n            })\n                .receive('error', () => {\n                resolve('error');\n            });\n            leavePush.send();\n            if (!this._canPush()) {\n                leavePush.trigger('ok', {});\n            }\n        }).finally(() => {\n            leavePush === null || leavePush === void 0 ? void 0 : leavePush.destroy();\n        });\n    }\n    /**\n     * Teardown the channel.\n     *\n     * Destroys and stops related timers.\n     */\n    teardown() {\n        this.pushBuffer.forEach((push) => push.destroy());\n        this.pushBuffer = [];\n        this.rejoinTimer.reset();\n        this.joinPush.destroy();\n        this.state = CHANNEL_STATES.closed;\n        this.bindings = {};\n    }\n    /** @internal */\n    async _fetchWithTimeout(url, options, timeout) {\n        const controller = new AbortController();\n        const id = setTimeout(() => controller.abort(), timeout);\n        const response = await this.socket.fetch(url, Object.assign(Object.assign({}, options), { signal: controller.signal }));\n        clearTimeout(id);\n        return response;\n    }\n    /** @internal */\n    _push(event, payload, timeout = this.timeout) {\n        if (!this.joinedOnce) {\n            throw `tried to push '${event}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;\n        }\n        let pushEvent = new Push(this, event, payload, timeout);\n        if (this._canPush()) {\n            pushEvent.send();\n        }\n        else {\n            this._addToPushBuffer(pushEvent);\n        }\n        return pushEvent;\n    }\n    /** @internal */\n    _addToPushBuffer(pushEvent) {\n        pushEvent.startTimeout();\n        this.pushBuffer.push(pushEvent);\n        // Enforce buffer size limit\n        if (this.pushBuffer.length > MAX_PUSH_BUFFER_SIZE) {\n            const removedPush = this.pushBuffer.shift();\n            if (removedPush) {\n                removedPush.destroy();\n                this.socket.log('channel', `discarded push due to buffer overflow: ${removedPush.event}`, removedPush.payload);\n            }\n        }\n    }\n    /**\n     * Overridable message hook\n     *\n     * Receives all events for specialized message handling before dispatching to the channel callbacks.\n     * Must return the payload, modified or unmodified.\n     *\n     * @internal\n     */\n    _onMessage(_event, payload, _ref) {\n        return payload;\n    }\n    /** @internal */\n    _isMember(topic) {\n        return this.topic === topic;\n    }\n    /** @internal */\n    _joinRef() {\n        return this.joinPush.ref;\n    }\n    /** @internal */\n    _trigger(type, payload, ref) {\n        var _a, _b;\n        const typeLower = type.toLocaleLowerCase();\n        const { close, error, leave, join } = CHANNEL_EVENTS;\n        const events = [close, error, leave, join];\n        if (ref && events.indexOf(typeLower) >= 0 && ref !== this._joinRef()) {\n            return;\n        }\n        let handledPayload = this._onMessage(typeLower, payload, ref);\n        if (payload && !handledPayload) {\n            throw 'channel onMessage callbacks must return the payload, modified or unmodified';\n        }\n        if (['insert', 'update', 'delete'].includes(typeLower)) {\n            (_a = this.bindings.postgres_changes) === null || _a === void 0 ? void 0 : _a.filter((bind) => {\n                var _a, _b, _c;\n                return ((_a = bind.filter) === null || _a === void 0 ? void 0 : _a.event) === '*' || ((_c = (_b = bind.filter) === null || _b === void 0 ? void 0 : _b.event) === null || _c === void 0 ? void 0 : _c.toLocaleLowerCase()) === typeLower;\n            }).map((bind) => bind.callback(handledPayload, ref));\n        }\n        else {\n            (_b = this.bindings[typeLower]) === null || _b === void 0 ? void 0 : _b.filter((bind) => {\n                var _a, _b, _c, _d, _e, _f, _g, _h;\n                if (['broadcast', 'presence', 'postgres_changes'].includes(typeLower)) {\n                    if ('id' in bind) {\n                        const bindId = bind.id;\n                        const bindEvent = (_a = bind.filter) === null || _a === void 0 ? void 0 : _a.event;\n                        return (bindId &&\n                            ((_b = payload.ids) === null || _b === void 0 ? void 0 : _b.includes(bindId)) &&\n                            (bindEvent === '*' ||\n                                (bindEvent === null || bindEvent === void 0 ? void 0 : bindEvent.toLocaleLowerCase()) === ((_c = payload.data) === null || _c === void 0 ? void 0 : _c.type.toLocaleLowerCase())) &&\n                            (!((_d = bind.filter) === null || _d === void 0 ? void 0 : _d.table) || bind.filter.table === ((_e = payload.data) === null || _e === void 0 ? void 0 : _e.table)));\n                    }\n                    else {\n                        const bindEvent = (_g = (_f = bind === null || bind === void 0 ? void 0 : bind.filter) === null || _f === void 0 ? void 0 : _f.event) === null || _g === void 0 ? void 0 : _g.toLocaleLowerCase();\n                        return bindEvent === '*' || bindEvent === ((_h = payload === null || payload === void 0 ? void 0 : payload.event) === null || _h === void 0 ? void 0 : _h.toLocaleLowerCase());\n                    }\n                }\n                else {\n                    return bind.type.toLocaleLowerCase() === typeLower;\n                }\n            }).map((bind) => {\n                if (typeof handledPayload === 'object' && 'ids' in handledPayload) {\n                    const postgresChanges = handledPayload.data;\n                    const { schema, table, commit_timestamp, type, errors } = postgresChanges;\n                    const enrichedPayload = {\n                        schema: schema,\n                        table: table,\n                        commit_timestamp: commit_timestamp,\n                        eventType: type,\n                        new: {},\n                        old: {},\n                        errors: errors,\n                    };\n                    handledPayload = Object.assign(Object.assign({}, enrichedPayload), this._getPayloadRecords(postgresChanges));\n                }\n                bind.callback(handledPayload, ref);\n            });\n        }\n    }\n    /** @internal */\n    _isClosed() {\n        return this.state === CHANNEL_STATES.closed;\n    }\n    /** @internal */\n    _isJoined() {\n        return this.state === CHANNEL_STATES.joined;\n    }\n    /** @internal */\n    _isJoining() {\n        return this.state === CHANNEL_STATES.joining;\n    }\n    /** @internal */\n    _isLeaving() {\n        return this.state === CHANNEL_STATES.leaving;\n    }\n    /** @internal */\n    _replyEventName(ref) {\n        return `chan_reply_${ref}`;\n    }\n    /** @internal */\n    _on(type, filter, callback) {\n        const typeLower = type.toLocaleLowerCase();\n        const binding = {\n            type: typeLower,\n            filter: filter,\n            callback: callback,\n        };\n        if (this.bindings[typeLower]) {\n            this.bindings[typeLower].push(binding);\n        }\n        else {\n            this.bindings[typeLower] = [binding];\n        }\n        return this;\n    }\n    /** @internal */\n    _off(type, filter) {\n        const typeLower = type.toLocaleLowerCase();\n        if (this.bindings[typeLower]) {\n            this.bindings[typeLower] = this.bindings[typeLower].filter((bind) => {\n                var _a;\n                return !(((_a = bind.type) === null || _a === void 0 ? void 0 : _a.toLocaleLowerCase()) === typeLower &&\n                    RealtimeChannel.isEqual(bind.filter, filter));\n            });\n        }\n        return this;\n    }\n    /** @internal */\n    static isEqual(obj1, obj2) {\n        if (Object.keys(obj1).length !== Object.keys(obj2).length) {\n            return false;\n        }\n        for (const k in obj1) {\n            if (obj1[k] !== obj2[k]) {\n                return false;\n            }\n        }\n        return true;\n    }\n    /**\n     * Compares two optional filter values for equality.\n     * Treats undefined, null, and empty string as equivalent empty values.\n     * @internal\n     */\n    static isFilterValueEqual(serverValue, clientValue) {\n        const normalizedServer = serverValue !== null && serverValue !== void 0 ? serverValue : undefined;\n        const normalizedClient = clientValue !== null && clientValue !== void 0 ? clientValue : undefined;\n        return normalizedServer === normalizedClient;\n    }\n    /** @internal */\n    _rejoinUntilConnected() {\n        this.rejoinTimer.scheduleTimeout();\n        if (this.socket.isConnected()) {\n            this._rejoin();\n        }\n    }\n    /**\n     * Registers a callback that will be executed when the channel closes.\n     *\n     * @internal\n     */\n    _onClose(callback) {\n        this._on(CHANNEL_EVENTS.close, {}, callback);\n    }\n    /**\n     * Registers a callback that will be executed when the channel encounteres an error.\n     *\n     * @internal\n     */\n    _onError(callback) {\n        this._on(CHANNEL_EVENTS.error, {}, (reason) => callback(reason));\n    }\n    /**\n     * Returns `true` if the socket is connected and the channel has been joined.\n     *\n     * @internal\n     */\n    _canPush() {\n        return this.socket.isConnected() && this._isJoined();\n    }\n    /** @internal */\n    _rejoin(timeout = this.timeout) {\n        if (this._isLeaving()) {\n            return;\n        }\n        this.socket._leaveOpenTopic(this.topic);\n        this.state = CHANNEL_STATES.joining;\n        this.joinPush.resend(timeout);\n    }\n    /** @internal */\n    _getPayloadRecords(payload) {\n        const records = {\n            new: {},\n            old: {},\n        };\n        if (payload.type === 'INSERT' || payload.type === 'UPDATE') {\n            records.new = Transformers.convertChangeData(payload.columns, payload.record);\n        }\n        if (payload.type === 'UPDATE' || payload.type === 'DELETE') {\n            records.old = Transformers.convertChangeData(payload.columns, payload.old_record);\n        }\n        return records;\n    }\n}\n//# sourceMappingURL=RealtimeChannel.js.map"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1270, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1275, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/node_modules/@supabase/realtime-js/dist/module/lib/serializer.js"],"sourcesContent":["export default class Serializer {\n    constructor(allowedMetadataKeys) {\n        this.HEADER_LENGTH = 1;\n        this.USER_BROADCAST_PUSH_META_LENGTH = 6;\n        this.KINDS = { userBroadcastPush: 3, userBroadcast: 4 };\n        this.BINARY_ENCODING = 0;\n        this.JSON_ENCODING = 1;\n        this.BROADCAST_EVENT = 'broadcast';\n        this.allowedMetadataKeys = [];\n        this.allowedMetadataKeys = allowedMetadataKeys !== null && allowedMetadataKeys !== void 0 ? allowedMetadataKeys : [];\n    }\n    encode(msg, callback) {\n        if (msg.event === this.BROADCAST_EVENT &&\n            !(msg.payload instanceof ArrayBuffer) &&\n            typeof msg.payload.event === 'string') {\n            return callback(this._binaryEncodeUserBroadcastPush(msg));\n        }\n        let payload = [msg.join_ref, msg.ref, msg.topic, msg.event, msg.payload];\n        return callback(JSON.stringify(payload));\n    }\n    _binaryEncodeUserBroadcastPush(message) {\n        var _a;\n        if (this._isArrayBuffer((_a = message.payload) === null || _a === void 0 ? void 0 : _a.payload)) {\n            return this._encodeBinaryUserBroadcastPush(message);\n        }\n        else {\n            return this._encodeJsonUserBroadcastPush(message);\n        }\n    }\n    _encodeBinaryUserBroadcastPush(message) {\n        var _a, _b;\n        const userPayload = (_b = (_a = message.payload) === null || _a === void 0 ? void 0 : _a.payload) !== null && _b !== void 0 ? _b : new ArrayBuffer(0);\n        return this._encodeUserBroadcastPush(message, this.BINARY_ENCODING, userPayload);\n    }\n    _encodeJsonUserBroadcastPush(message) {\n        var _a, _b;\n        const userPayload = (_b = (_a = message.payload) === null || _a === void 0 ? void 0 : _a.payload) !== null && _b !== void 0 ? _b : {};\n        const encoder = new TextEncoder();\n        const encodedUserPayload = encoder.encode(JSON.stringify(userPayload)).buffer;\n        return this._encodeUserBroadcastPush(message, this.JSON_ENCODING, encodedUserPayload);\n    }\n    _encodeUserBroadcastPush(message, encodingType, encodedPayload) {\n        var _a, _b;\n        const topic = message.topic;\n        const ref = (_a = message.ref) !== null && _a !== void 0 ? _a : '';\n        const joinRef = (_b = message.join_ref) !== null && _b !== void 0 ? _b : '';\n        const userEvent = message.payload.event;\n        // Filter metadata based on allowed keys\n        const rest = this.allowedMetadataKeys\n            ? this._pick(message.payload, this.allowedMetadataKeys)\n            : {};\n        const metadata = Object.keys(rest).length === 0 ? '' : JSON.stringify(rest);\n        // Validate lengths don't exceed uint8 max value (255)\n        if (joinRef.length > 255) {\n            throw new Error(`joinRef length ${joinRef.length} exceeds maximum of 255`);\n        }\n        if (ref.length > 255) {\n            throw new Error(`ref length ${ref.length} exceeds maximum of 255`);\n        }\n        if (topic.length > 255) {\n            throw new Error(`topic length ${topic.length} exceeds maximum of 255`);\n        }\n        if (userEvent.length > 255) {\n            throw new Error(`userEvent length ${userEvent.length} exceeds maximum of 255`);\n        }\n        if (metadata.length > 255) {\n            throw new Error(`metadata length ${metadata.length} exceeds maximum of 255`);\n        }\n        const metaLength = this.USER_BROADCAST_PUSH_META_LENGTH +\n            joinRef.length +\n            ref.length +\n            topic.length +\n            userEvent.length +\n            metadata.length;\n        const header = new ArrayBuffer(this.HEADER_LENGTH + metaLength);\n        let view = new DataView(header);\n        let offset = 0;\n        view.setUint8(offset++, this.KINDS.userBroadcastPush); // kind\n        view.setUint8(offset++, joinRef.length);\n        view.setUint8(offset++, ref.length);\n        view.setUint8(offset++, topic.length);\n        view.setUint8(offset++, userEvent.length);\n        view.setUint8(offset++, metadata.length);\n        view.setUint8(offset++, encodingType);\n        Array.from(joinRef, (char) => view.setUint8(offset++, char.charCodeAt(0)));\n        Array.from(ref, (char) => view.setUint8(offset++, char.charCodeAt(0)));\n        Array.from(topic, (char) => view.setUint8(offset++, char.charCodeAt(0)));\n        Array.from(userEvent, (char) => view.setUint8(offset++, char.charCodeAt(0)));\n        Array.from(metadata, (char) => view.setUint8(offset++, char.charCodeAt(0)));\n        var combined = new Uint8Array(header.byteLength + encodedPayload.byteLength);\n        combined.set(new Uint8Array(header), 0);\n        combined.set(new Uint8Array(encodedPayload), header.byteLength);\n        return combined.buffer;\n    }\n    decode(rawPayload, callback) {\n        if (this._isArrayBuffer(rawPayload)) {\n            let result = this._binaryDecode(rawPayload);\n            return callback(result);\n        }\n        if (typeof rawPayload === 'string') {\n            const jsonPayload = JSON.parse(rawPayload);\n            const [join_ref, ref, topic, event, payload] = jsonPayload;\n            return callback({ join_ref, ref, topic, event, payload });\n        }\n        return callback({});\n    }\n    _binaryDecode(buffer) {\n        const view = new DataView(buffer);\n        const kind = view.getUint8(0);\n        const decoder = new TextDecoder();\n        switch (kind) {\n            case this.KINDS.userBroadcast:\n                return this._decodeUserBroadcast(buffer, view, decoder);\n        }\n    }\n    _decodeUserBroadcast(buffer, view, decoder) {\n        const topicSize = view.getUint8(1);\n        const userEventSize = view.getUint8(2);\n        const metadataSize = view.getUint8(3);\n        const payloadEncoding = view.getUint8(4);\n        let offset = this.HEADER_LENGTH + 4;\n        const topic = decoder.decode(buffer.slice(offset, offset + topicSize));\n        offset = offset + topicSize;\n        const userEvent = decoder.decode(buffer.slice(offset, offset + userEventSize));\n        offset = offset + userEventSize;\n        const metadata = decoder.decode(buffer.slice(offset, offset + metadataSize));\n        offset = offset + metadataSize;\n        const payload = buffer.slice(offset, buffer.byteLength);\n        const parsedPayload = payloadEncoding === this.JSON_ENCODING ? JSON.parse(decoder.decode(payload)) : payload;\n        const data = {\n            type: this.BROADCAST_EVENT,\n            event: userEvent,\n            payload: parsedPayload,\n        };\n        // Metadata is optional and always JSON encoded\n        if (metadataSize > 0) {\n            data['meta'] = JSON.parse(metadata);\n        }\n        return { join_ref: null, ref: null, topic: topic, event: this.BROADCAST_EVENT, payload: data };\n    }\n    _isArrayBuffer(buffer) {\n        var _a;\n        return buffer instanceof ArrayBuffer || ((_a = buffer === null || buffer === void 0 ? void 0 : buffer.constructor) === null || _a === void 0 ? void 0 : _a.name) === 'ArrayBuffer';\n    }\n    _pick(obj, keys) {\n        if (!obj || typeof obj !== 'object') {\n            return {};\n        }\n        return Object.fromEntries(Object.entries(obj).filter(([key]) => keys.includes(key)));\n    }\n}\n//# sourceMappingURL=serializer.js.map"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1440, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1445, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/node_modules/@supabase/realtime-js/dist/module/lib/websocket-factory.js"],"sourcesContent":["/**\n * Utilities for creating WebSocket instances across runtimes.\n */\nexport class WebSocketFactory {\n    /**\n     * Static-only utility  prevent instantiation.\n     */\n    constructor() { }\n    static detectEnvironment() {\n        var _a;\n        if (typeof WebSocket !== 'undefined') {\n            return { type: 'native', constructor: WebSocket };\n        }\n        if (typeof globalThis !== 'undefined' && typeof globalThis.WebSocket !== 'undefined') {\n            return { type: 'native', constructor: globalThis.WebSocket };\n        }\n        if (typeof global !== 'undefined' && typeof global.WebSocket !== 'undefined') {\n            return { type: 'native', constructor: global.WebSocket };\n        }\n        if (typeof globalThis !== 'undefined' &&\n            typeof globalThis.WebSocketPair !== 'undefined' &&\n            typeof globalThis.WebSocket === 'undefined') {\n            return {\n                type: 'cloudflare',\n                error: 'Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.',\n                workaround: 'Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime.',\n            };\n        }\n        if ((typeof globalThis !== 'undefined' && globalThis.EdgeRuntime) ||\n            (typeof navigator !== 'undefined' && ((_a = navigator.userAgent) === null || _a === void 0 ? void 0 : _a.includes('Vercel-Edge')))) {\n            return {\n                type: 'unsupported',\n                error: 'Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.',\n                workaround: 'Use serverless functions or a different deployment target for WebSocket functionality.',\n            };\n        }\n        // Use dynamic property access to avoid Next.js Edge Runtime static analysis warnings\n        const _process = globalThis['process'];\n        if (_process) {\n            const processVersions = _process['versions'];\n            if (processVersions && processVersions['node']) {\n                // Remove 'v' prefix if present and parse the major version\n                const versionString = processVersions['node'];\n                const nodeVersion = parseInt(versionString.replace(/^v/, '').split('.')[0]);\n                // Node.js 22+ should have native WebSocket\n                if (nodeVersion >= 22) {\n                    // Check if native WebSocket is available (should be in Node.js 22+)\n                    if (typeof globalThis.WebSocket !== 'undefined') {\n                        return { type: 'native', constructor: globalThis.WebSocket };\n                    }\n                    // If not available, user needs to provide it\n                    return {\n                        type: 'unsupported',\n                        error: `Node.js ${nodeVersion} detected but native WebSocket not found.`,\n                        workaround: 'Provide a WebSocket implementation via the transport option.',\n                    };\n                }\n                // Node.js < 22 doesn't have native WebSocket\n                return {\n                    type: 'unsupported',\n                    error: `Node.js ${nodeVersion} detected without native WebSocket support.`,\n                    workaround: 'For Node.js < 22, install \"ws\" package and provide it via the transport option:\\n' +\n                        'import ws from \"ws\"\\n' +\n                        'new RealtimeClient(url, { transport: ws })',\n                };\n            }\n        }\n        return {\n            type: 'unsupported',\n            error: 'Unknown JavaScript runtime without WebSocket support.',\n            workaround: \"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation.\",\n        };\n    }\n    /**\n     * Returns the best available WebSocket constructor for the current runtime.\n     *\n     * @example\n     * ```ts\n     * const WS = WebSocketFactory.getWebSocketConstructor()\n     * const socket = new WS('wss://realtime.supabase.co/socket')\n     * ```\n     */\n    static getWebSocketConstructor() {\n        const env = this.detectEnvironment();\n        if (env.constructor) {\n            return env.constructor;\n        }\n        let errorMessage = env.error || 'WebSocket not supported in this environment.';\n        if (env.workaround) {\n            errorMessage += `\\n\\nSuggested solution: ${env.workaround}`;\n        }\n        throw new Error(errorMessage);\n    }\n    /**\n     * Creates a WebSocket using the detected constructor.\n     *\n     * @example\n     * ```ts\n     * const socket = WebSocketFactory.createWebSocket('wss://realtime.supabase.co/socket')\n     * ```\n     */\n    static createWebSocket(url, protocols) {\n        const WS = this.getWebSocketConstructor();\n        return new WS(url, protocols);\n    }\n    /**\n     * Detects whether the runtime can establish WebSocket connections.\n     *\n     * @example\n     * ```ts\n     * if (!WebSocketFactory.isWebSocketSupported()) {\n     *   console.warn('Falling back to long polling')\n     * }\n     * ```\n     */\n    static isWebSocketSupported() {\n        try {\n            const env = this.detectEnvironment();\n            return env.type === 'native' || env.type === 'ws';\n        }\n        catch (_a) {\n            return false;\n        }\n    }\n}\nexport default WebSocketFactory;\n//# sourceMappingURL=websocket-factory.js.map"],"names":[],"mappings":"AAAA;;CAEC;;;;AACM,MAAM;IACT;;KAEC,GACD,aAAc,CAAE;IAChB,OAAO,oBAAoB;QACvB,IAAI;QACJ,IAAI,OAAO,cAAc,aAAa;YAClC,OAAO;gBAAE,MAAM;gBAAU,aAAa;YAAU;QACpD;QACA,IAAI,OAAO,eAAe,eAAe,OAAO,WAAW,SAAS,KAAK,aAAa;YAClF,OAAO;gBAAE,MAAM;gBAAU,aAAa,WAAW,SAAS;YAAC;QAC/D;QACA,IAAI,OAAO,WAAW,eAAe,OAAO,OAAO,SAAS,KAAK,aAAa;YAC1E,OAAO;gBAAE,MAAM;gBAAU,aAAa,OAAO,SAAS;YAAC;QAC3D;QACA,IAAI,OAAO,eAAe,eACtB,OAAO,WAAW,aAAa,KAAK,eACpC,OAAO,WAAW,SAAS,KAAK,aAAa;YAC7C,OAAO;gBACH,MAAM;gBACN,OAAO;gBACP,YAAY;YAChB;QACJ;QACA,IAAI,AAAC,OAAO,eAAe,eAAe,WAAW,WAAW,IAC3D,OAAO,cAAc,eAAe,CAAC,CAAC,KAAK,UAAU,SAAS,MAAM,QAAQ,OAAO,KAAK,IAAI,KAAK,IAAI,GAAG,QAAQ,CAAC,cAAc,GAAI;YACpI,OAAO;gBACH,MAAM;gBACN,OAAO;gBACP,YAAY;YAChB;QACJ;QACA,qFAAqF;QACrF,MAAM,WAAW,UAAU,CAAC,UAAU;QACtC,IAAI,UAAU;YACV,MAAM,kBAAkB,QAAQ,CAAC,WAAW;YAC5C,IAAI,mBAAmB,eAAe,CAAC,OAAO,EAAE;gBAC5C,2DAA2D;gBAC3D,MAAM,gBAAgB,eAAe,CAAC,OAAO;gBAC7C,MAAM,cAAc,SAAS,cAAc,OAAO,CAAC,MAAM,IAAI,KAAK,CAAC,IAAI,CAAC,EAAE;gBAC1E,2CAA2C;gBAC3C,IAAI,eAAe,IAAI;oBACnB,oEAAoE;oBACpE,IAAI,OAAO,WAAW,SAAS,KAAK,aAAa;wBAC7C,OAAO;4BAAE,MAAM;4BAAU,aAAa,WAAW,SAAS;wBAAC;oBAC/D;oBACA,6CAA6C;oBAC7C,OAAO;wBACH,MAAM;wBACN,OAAO,CAAC,QAAQ,EAAE,YAAY,yCAAyC,CAAC;wBACxE,YAAY;oBAChB;gBACJ;gBACA,6CAA6C;gBAC7C,OAAO;oBACH,MAAM;oBACN,OAAO,CAAC,QAAQ,EAAE,YAAY,2CAA2C,CAAC;oBAC1E,YAAY,sFACR,0BACA;gBACR;YACJ;QACJ;QACA,OAAO;YACH,MAAM;YACN,OAAO;YACP,YAAY;QAChB;IACJ;IACA;;;;;;;;KAQC,GACD,OAAO,0BAA0B;QAC7B,MAAM,MAAM,IAAI,CAAC,iBAAiB;QAClC,IAAI,IAAI,WAAW,EAAE;YACjB,OAAO,IAAI,WAAW;QAC1B;QACA,IAAI,eAAe,IAAI,KAAK,IAAI;QAChC,IAAI,IAAI,UAAU,EAAE;YAChB,gBAAgB,CAAC,wBAAwB,EAAE,IAAI,UAAU,CAAC,CAAC;QAC/D;QACA,MAAM,IAAI,MAAM;IACpB;IACA;;;;;;;KAOC,GACD,OAAO,gBAAgB,GAAG,EAAE,SAAS,EAAE;QACnC,MAAM,KAAK,IAAI,CAAC,uBAAuB;QACvC,OAAO,IAAI,GAAG,KAAK;IACvB;IACA;;;;;;;;;KASC,GACD,OAAO,uBAAuB;QAC1B,IAAI;YACA,MAAM,MAAM,IAAI,CAAC,iBAAiB;YAClC,OAAO,IAAI,IAAI,KAAK,YAAY,IAAI,IAAI,KAAK;QACjD,EACA,OAAO,IAAI;YACP,OAAO;QACX;IACJ;AACJ;uCACe;CACf,6CAA6C"}},
    {"offset": {"line": 1577, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1582, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/node_modules/@supabase/realtime-js/dist/module/RealtimeClient.js"],"sourcesContent":["import WebSocketFactory from './lib/websocket-factory';\nimport { CHANNEL_EVENTS, CONNECTION_STATE, DEFAULT_VERSION, DEFAULT_TIMEOUT, SOCKET_STATES, TRANSPORTS, DEFAULT_VSN, VSN_1_0_0, VSN_2_0_0, WS_CLOSE_NORMAL, } from './lib/constants';\nimport Serializer from './lib/serializer';\nimport Timer from './lib/timer';\nimport { httpEndpointURL } from './lib/transformers';\nimport RealtimeChannel from './RealtimeChannel';\nconst noop = () => { };\n// Connection-related constants\nconst CONNECTION_TIMEOUTS = {\n    HEARTBEAT_INTERVAL: 25000,\n    RECONNECT_DELAY: 10,\n    HEARTBEAT_TIMEOUT_FALLBACK: 100,\n};\nconst RECONNECT_INTERVALS = [1000, 2000, 5000, 10000];\nconst DEFAULT_RECONNECT_FALLBACK = 10000;\nconst WORKER_SCRIPT = `\n  addEventListener(\"message\", (e) => {\n    if (e.data.event === \"start\") {\n      setInterval(() => postMessage({ event: \"keepAlive\" }), e.data.interval);\n    }\n  });`;\nexport default class RealtimeClient {\n    /**\n     * Initializes the Socket.\n     *\n     * @param endPoint The string WebSocket endpoint, ie, \"ws://example.com/socket\", \"wss://example.com\", \"/socket\" (inherited host & protocol)\n     * @param httpEndpoint The string HTTP endpoint, ie, \"https://example.com\", \"/\" (inherited host & protocol)\n     * @param options.transport The Websocket Transport, for example WebSocket. This can be a custom implementation\n     * @param options.timeout The default timeout in milliseconds to trigger push timeouts.\n     * @param options.params The optional params to pass when connecting.\n     * @param options.headers Deprecated: headers cannot be set on websocket connections and this option will be removed in the future.\n     * @param options.heartbeatIntervalMs The millisec interval to send a heartbeat message.\n     * @param options.heartbeatCallback The optional function to handle heartbeat status and latency.\n     * @param options.logger The optional function for specialized logging, ie: logger: (kind, msg, data) => { console.log(`${kind}: ${msg}`, data) }\n     * @param options.logLevel Sets the log level for Realtime\n     * @param options.encode The function to encode outgoing messages. Defaults to JSON: (payload, callback) => callback(JSON.stringify(payload))\n     * @param options.decode The function to decode incoming messages. Defaults to Serializer's decode.\n     * @param options.reconnectAfterMs he optional function that returns the millsec reconnect interval. Defaults to stepped backoff off.\n     * @param options.worker Use Web Worker to set a side flow. Defaults to false.\n     * @param options.workerUrl The URL of the worker script. Defaults to https://realtime.supabase.com/worker.js that includes a heartbeat event call to keep the connection alive.\n     * @example\n     * ```ts\n     * import RealtimeClient from '@supabase/realtime-js'\n     *\n     * const client = new RealtimeClient('https://xyzcompany.supabase.co/realtime/v1', {\n     *   params: { apikey: 'public-anon-key' },\n     * })\n     * client.connect()\n     * ```\n     */\n    constructor(endPoint, options) {\n        var _a;\n        this.accessTokenValue = null;\n        this.apiKey = null;\n        this._manuallySetToken = false;\n        this.channels = new Array();\n        this.endPoint = '';\n        this.httpEndpoint = '';\n        /** @deprecated headers cannot be set on websocket connections */\n        this.headers = {};\n        this.params = {};\n        this.timeout = DEFAULT_TIMEOUT;\n        this.transport = null;\n        this.heartbeatIntervalMs = CONNECTION_TIMEOUTS.HEARTBEAT_INTERVAL;\n        this.heartbeatTimer = undefined;\n        this.pendingHeartbeatRef = null;\n        this.heartbeatCallback = noop;\n        this.ref = 0;\n        this.reconnectTimer = null;\n        this.vsn = DEFAULT_VSN;\n        this.logger = noop;\n        this.conn = null;\n        this.sendBuffer = [];\n        this.serializer = new Serializer();\n        this.stateChangeCallbacks = {\n            open: [],\n            close: [],\n            error: [],\n            message: [],\n        };\n        this.accessToken = null;\n        this._connectionState = 'disconnected';\n        this._wasManualDisconnect = false;\n        this._authPromise = null;\n        this._heartbeatSentAt = null;\n        /**\n         * Use either custom fetch, if provided, or default fetch to make HTTP requests\n         *\n         * @internal\n         */\n        this._resolveFetch = (customFetch) => {\n            if (customFetch) {\n                return (...args) => customFetch(...args);\n            }\n            return (...args) => fetch(...args);\n        };\n        // Validate required parameters\n        if (!((_a = options === null || options === void 0 ? void 0 : options.params) === null || _a === void 0 ? void 0 : _a.apikey)) {\n            throw new Error('API key is required to connect to Realtime');\n        }\n        this.apiKey = options.params.apikey;\n        // Initialize endpoint URLs\n        this.endPoint = `${endPoint}/${TRANSPORTS.websocket}`;\n        this.httpEndpoint = httpEndpointURL(endPoint);\n        this._initializeOptions(options);\n        this._setupReconnectionTimer();\n        this.fetch = this._resolveFetch(options === null || options === void 0 ? void 0 : options.fetch);\n    }\n    /**\n     * Connects the socket, unless already connected.\n     */\n    connect() {\n        // Skip if already connecting, disconnecting, or connected\n        if (this.isConnecting() ||\n            this.isDisconnecting() ||\n            (this.conn !== null && this.isConnected())) {\n            return;\n        }\n        this._setConnectionState('connecting');\n        // Trigger auth if needed and not already in progress\n        // This ensures auth is called for standalone RealtimeClient usage\n        // while avoiding race conditions with SupabaseClient's immediate setAuth call\n        if (this.accessToken && !this._authPromise) {\n            this._setAuthSafely('connect');\n        }\n        // Establish WebSocket connection\n        if (this.transport) {\n            // Use custom transport if provided\n            this.conn = new this.transport(this.endpointURL());\n        }\n        else {\n            // Try to use native WebSocket\n            try {\n                this.conn = WebSocketFactory.createWebSocket(this.endpointURL());\n            }\n            catch (error) {\n                this._setConnectionState('disconnected');\n                const errorMessage = error.message;\n                // Provide helpful error message based on environment\n                if (errorMessage.includes('Node.js')) {\n                    throw new Error(`${errorMessage}\\n\\n` +\n                        'To use Realtime in Node.js, you need to provide a WebSocket implementation:\\n\\n' +\n                        'Option 1: Use Node.js 22+ which has native WebSocket support\\n' +\n                        'Option 2: Install and provide the \"ws\" package:\\n\\n' +\n                        '  npm install ws\\n\\n' +\n                        '  import ws from \"ws\"\\n' +\n                        '  const client = new RealtimeClient(url, {\\n' +\n                        '    ...options,\\n' +\n                        '    transport: ws\\n' +\n                        '  })');\n                }\n                throw new Error(`WebSocket not available: ${errorMessage}`);\n            }\n        }\n        this._setupConnectionHandlers();\n    }\n    /**\n     * Returns the URL of the websocket.\n     * @returns string The URL of the websocket.\n     */\n    endpointURL() {\n        return this._appendParams(this.endPoint, Object.assign({}, this.params, { vsn: this.vsn }));\n    }\n    /**\n     * Disconnects the socket.\n     *\n     * @param code A numeric status code to send on disconnect.\n     * @param reason A custom reason for the disconnect.\n     */\n    disconnect(code, reason) {\n        if (this.isDisconnecting()) {\n            return;\n        }\n        this._setConnectionState('disconnecting', true);\n        if (this.conn) {\n            // Setup fallback timer to prevent hanging in disconnecting state\n            const fallbackTimer = setTimeout(() => {\n                this._setConnectionState('disconnected');\n            }, 100);\n            this.conn.onclose = () => {\n                clearTimeout(fallbackTimer);\n                this._setConnectionState('disconnected');\n            };\n            // Close the WebSocket connection if close method exists\n            if (typeof this.conn.close === 'function') {\n                if (code) {\n                    this.conn.close(code, reason !== null && reason !== void 0 ? reason : '');\n                }\n                else {\n                    this.conn.close();\n                }\n            }\n            this._teardownConnection();\n        }\n        else {\n            this._setConnectionState('disconnected');\n        }\n    }\n    /**\n     * Returns all created channels\n     */\n    getChannels() {\n        return this.channels;\n    }\n    /**\n     * Unsubscribes and removes a single channel\n     * @param channel A RealtimeChannel instance\n     */\n    async removeChannel(channel) {\n        const status = await channel.unsubscribe();\n        if (this.channels.length === 0) {\n            this.disconnect();\n        }\n        return status;\n    }\n    /**\n     * Unsubscribes and removes all channels\n     */\n    async removeAllChannels() {\n        const values_1 = await Promise.all(this.channels.map((channel) => channel.unsubscribe()));\n        this.channels = [];\n        this.disconnect();\n        return values_1;\n    }\n    /**\n     * Logs the message.\n     *\n     * For customized logging, `this.logger` can be overridden.\n     */\n    log(kind, msg, data) {\n        this.logger(kind, msg, data);\n    }\n    /**\n     * Returns the current state of the socket.\n     */\n    connectionState() {\n        switch (this.conn && this.conn.readyState) {\n            case SOCKET_STATES.connecting:\n                return CONNECTION_STATE.Connecting;\n            case SOCKET_STATES.open:\n                return CONNECTION_STATE.Open;\n            case SOCKET_STATES.closing:\n                return CONNECTION_STATE.Closing;\n            default:\n                return CONNECTION_STATE.Closed;\n        }\n    }\n    /**\n     * Returns `true` is the connection is open.\n     */\n    isConnected() {\n        return this.connectionState() === CONNECTION_STATE.Open;\n    }\n    /**\n     * Returns `true` if the connection is currently connecting.\n     */\n    isConnecting() {\n        return this._connectionState === 'connecting';\n    }\n    /**\n     * Returns `true` if the connection is currently disconnecting.\n     */\n    isDisconnecting() {\n        return this._connectionState === 'disconnecting';\n    }\n    /**\n     * Creates (or reuses) a {@link RealtimeChannel} for the provided topic.\n     *\n     * Topics are automatically prefixed with `realtime:` to match the Realtime service.\n     * If a channel with the same topic already exists it will be returned instead of creating\n     * a duplicate connection.\n     */\n    channel(topic, params = { config: {} }) {\n        const realtimeTopic = `realtime:${topic}`;\n        const exists = this.getChannels().find((c) => c.topic === realtimeTopic);\n        if (!exists) {\n            const chan = new RealtimeChannel(`realtime:${topic}`, params, this);\n            this.channels.push(chan);\n            return chan;\n        }\n        else {\n            return exists;\n        }\n    }\n    /**\n     * Push out a message if the socket is connected.\n     *\n     * If the socket is not connected, the message gets enqueued within a local buffer, and sent out when a connection is next established.\n     */\n    push(data) {\n        const { topic, event, payload, ref } = data;\n        const callback = () => {\n            this.encode(data, (result) => {\n                var _a;\n                (_a = this.conn) === null || _a === void 0 ? void 0 : _a.send(result);\n            });\n        };\n        this.log('push', `${topic} ${event} (${ref})`, payload);\n        if (this.isConnected()) {\n            callback();\n        }\n        else {\n            this.sendBuffer.push(callback);\n        }\n    }\n    /**\n     * Sets the JWT access token used for channel subscription authorization and Realtime RLS.\n     *\n     * If param is null it will use the `accessToken` callback function or the token set on the client.\n     *\n     * On callback used, it will set the value of the token internal to the client.\n     *\n     * When a token is explicitly provided, it will be preserved across channel operations\n     * (including removeChannel and resubscribe). The `accessToken` callback will not be\n     * invoked until `setAuth()` is called without arguments.\n     *\n     * @param token A JWT string to override the token set on the client.\n     *\n     * @example\n     * // Use a manual token (preserved across resubscribes, ignores accessToken callback)\n     * client.realtime.setAuth('my-custom-jwt')\n     *\n     * // Switch back to using the accessToken callback\n     * client.realtime.setAuth()\n     */\n    async setAuth(token = null) {\n        this._authPromise = this._performAuth(token);\n        try {\n            await this._authPromise;\n        }\n        finally {\n            this._authPromise = null;\n        }\n    }\n    /**\n     * Returns true if the current access token was explicitly set via setAuth(token),\n     * false if it was obtained via the accessToken callback.\n     * @internal\n     */\n    _isManualToken() {\n        return this._manuallySetToken;\n    }\n    /**\n     * Sends a heartbeat message if the socket is connected.\n     */\n    async sendHeartbeat() {\n        var _a;\n        if (!this.isConnected()) {\n            try {\n                this.heartbeatCallback('disconnected');\n            }\n            catch (e) {\n                this.log('error', 'error in heartbeat callback', e);\n            }\n            return;\n        }\n        // Handle heartbeat timeout and force reconnection if needed\n        if (this.pendingHeartbeatRef) {\n            this.pendingHeartbeatRef = null;\n            this._heartbeatSentAt = null;\n            this.log('transport', 'heartbeat timeout. Attempting to re-establish connection');\n            try {\n                this.heartbeatCallback('timeout');\n            }\n            catch (e) {\n                this.log('error', 'error in heartbeat callback', e);\n            }\n            // Force reconnection after heartbeat timeout\n            this._wasManualDisconnect = false;\n            (_a = this.conn) === null || _a === void 0 ? void 0 : _a.close(WS_CLOSE_NORMAL, 'heartbeat timeout');\n            setTimeout(() => {\n                var _a;\n                if (!this.isConnected()) {\n                    (_a = this.reconnectTimer) === null || _a === void 0 ? void 0 : _a.scheduleTimeout();\n                }\n            }, CONNECTION_TIMEOUTS.HEARTBEAT_TIMEOUT_FALLBACK);\n            return;\n        }\n        // Send heartbeat message to server\n        this._heartbeatSentAt = Date.now();\n        this.pendingHeartbeatRef = this._makeRef();\n        this.push({\n            topic: 'phoenix',\n            event: 'heartbeat',\n            payload: {},\n            ref: this.pendingHeartbeatRef,\n        });\n        try {\n            this.heartbeatCallback('sent');\n        }\n        catch (e) {\n            this.log('error', 'error in heartbeat callback', e);\n        }\n        this._setAuthSafely('heartbeat');\n    }\n    /**\n     * Sets a callback that receives lifecycle events for internal heartbeat messages.\n     * Useful for instrumenting connection health (e.g. sent/ok/timeout/disconnected).\n     */\n    onHeartbeat(callback) {\n        this.heartbeatCallback = callback;\n    }\n    /**\n     * Flushes send buffer\n     */\n    flushSendBuffer() {\n        if (this.isConnected() && this.sendBuffer.length > 0) {\n            this.sendBuffer.forEach((callback) => callback());\n            this.sendBuffer = [];\n        }\n    }\n    /**\n     * Return the next message ref, accounting for overflows\n     *\n     * @internal\n     */\n    _makeRef() {\n        let newRef = this.ref + 1;\n        if (newRef === this.ref) {\n            this.ref = 0;\n        }\n        else {\n            this.ref = newRef;\n        }\n        return this.ref.toString();\n    }\n    /**\n     * Unsubscribe from channels with the specified topic.\n     *\n     * @internal\n     */\n    _leaveOpenTopic(topic) {\n        let dupChannel = this.channels.find((c) => c.topic === topic && (c._isJoined() || c._isJoining()));\n        if (dupChannel) {\n            this.log('transport', `leaving duplicate topic \"${topic}\"`);\n            dupChannel.unsubscribe();\n        }\n    }\n    /**\n     * Removes a subscription from the socket.\n     *\n     * @param channel An open subscription.\n     *\n     * @internal\n     */\n    _remove(channel) {\n        this.channels = this.channels.filter((c) => c.topic !== channel.topic);\n    }\n    /** @internal */\n    _onConnMessage(rawMessage) {\n        this.decode(rawMessage.data, (msg) => {\n            // Handle heartbeat responses\n            if (msg.topic === 'phoenix' &&\n                msg.event === 'phx_reply' &&\n                msg.ref &&\n                msg.ref === this.pendingHeartbeatRef) {\n                const latency = this._heartbeatSentAt ? Date.now() - this._heartbeatSentAt : undefined;\n                try {\n                    this.heartbeatCallback(msg.payload.status === 'ok' ? 'ok' : 'error', latency);\n                }\n                catch (e) {\n                    this.log('error', 'error in heartbeat callback', e);\n                }\n                this._heartbeatSentAt = null;\n                this.pendingHeartbeatRef = null;\n            }\n            // Log incoming message\n            const { topic, event, payload, ref } = msg;\n            const refString = ref ? `(${ref})` : '';\n            const status = payload.status || '';\n            this.log('receive', `${status} ${topic} ${event} ${refString}`.trim(), payload);\n            // Route message to appropriate channels\n            this.channels\n                .filter((channel) => channel._isMember(topic))\n                .forEach((channel) => channel._trigger(event, payload, ref));\n            this._triggerStateCallbacks('message', msg);\n        });\n    }\n    /**\n     * Clear specific timer\n     * @internal\n     */\n    _clearTimer(timer) {\n        var _a;\n        if (timer === 'heartbeat' && this.heartbeatTimer) {\n            clearInterval(this.heartbeatTimer);\n            this.heartbeatTimer = undefined;\n        }\n        else if (timer === 'reconnect') {\n            (_a = this.reconnectTimer) === null || _a === void 0 ? void 0 : _a.reset();\n        }\n    }\n    /**\n     * Clear all timers\n     * @internal\n     */\n    _clearAllTimers() {\n        this._clearTimer('heartbeat');\n        this._clearTimer('reconnect');\n    }\n    /**\n     * Setup connection handlers for WebSocket events\n     * @internal\n     */\n    _setupConnectionHandlers() {\n        if (!this.conn)\n            return;\n        // Set binary type if supported (browsers and most WebSocket implementations)\n        if ('binaryType' in this.conn) {\n            ;\n            this.conn.binaryType = 'arraybuffer';\n        }\n        this.conn.onopen = () => this._onConnOpen();\n        this.conn.onerror = (error) => this._onConnError(error);\n        this.conn.onmessage = (event) => this._onConnMessage(event);\n        this.conn.onclose = (event) => this._onConnClose(event);\n        if (this.conn.readyState === SOCKET_STATES.open) {\n            this._onConnOpen();\n        }\n    }\n    /**\n     * Teardown connection and cleanup resources\n     * @internal\n     */\n    _teardownConnection() {\n        if (this.conn) {\n            if (this.conn.readyState === SOCKET_STATES.open ||\n                this.conn.readyState === SOCKET_STATES.connecting) {\n                try {\n                    this.conn.close();\n                }\n                catch (e) {\n                    this.log('error', 'Error closing connection', e);\n                }\n            }\n            this.conn.onopen = null;\n            this.conn.onerror = null;\n            this.conn.onmessage = null;\n            this.conn.onclose = null;\n            this.conn = null;\n        }\n        this._clearAllTimers();\n        this._terminateWorker();\n        this.channels.forEach((channel) => channel.teardown());\n    }\n    /** @internal */\n    _onConnOpen() {\n        this._setConnectionState('connected');\n        this.log('transport', `connected to ${this.endpointURL()}`);\n        // Wait for any pending auth operations before flushing send buffer\n        // This ensures channel join messages include the correct access token\n        const authPromise = this._authPromise ||\n            (this.accessToken && !this.accessTokenValue ? this.setAuth() : Promise.resolve());\n        authPromise\n            .then(() => {\n            this.flushSendBuffer();\n        })\n            .catch((e) => {\n            this.log('error', 'error waiting for auth on connect', e);\n            // Proceed anyway to avoid hanging connections\n            this.flushSendBuffer();\n        });\n        this._clearTimer('reconnect');\n        if (!this.worker) {\n            this._startHeartbeat();\n        }\n        else {\n            if (!this.workerRef) {\n                this._startWorkerHeartbeat();\n            }\n        }\n        this._triggerStateCallbacks('open');\n    }\n    /** @internal */\n    _startHeartbeat() {\n        this.heartbeatTimer && clearInterval(this.heartbeatTimer);\n        this.heartbeatTimer = setInterval(() => this.sendHeartbeat(), this.heartbeatIntervalMs);\n    }\n    /** @internal */\n    _startWorkerHeartbeat() {\n        if (this.workerUrl) {\n            this.log('worker', `starting worker for from ${this.workerUrl}`);\n        }\n        else {\n            this.log('worker', `starting default worker`);\n        }\n        const objectUrl = this._workerObjectUrl(this.workerUrl);\n        this.workerRef = new Worker(objectUrl);\n        this.workerRef.onerror = (error) => {\n            this.log('worker', 'worker error', error.message);\n            this._terminateWorker();\n        };\n        this.workerRef.onmessage = (event) => {\n            if (event.data.event === 'keepAlive') {\n                this.sendHeartbeat();\n            }\n        };\n        this.workerRef.postMessage({\n            event: 'start',\n            interval: this.heartbeatIntervalMs,\n        });\n    }\n    /**\n     * Terminate the Web Worker and clear the reference\n     * @internal\n     */\n    _terminateWorker() {\n        if (this.workerRef) {\n            this.log('worker', 'terminating worker');\n            this.workerRef.terminate();\n            this.workerRef = undefined;\n        }\n    }\n    /** @internal */\n    _onConnClose(event) {\n        var _a;\n        this._setConnectionState('disconnected');\n        this.log('transport', 'close', event);\n        this._triggerChanError();\n        this._clearTimer('heartbeat');\n        // Only schedule reconnection if it wasn't a manual disconnect\n        if (!this._wasManualDisconnect) {\n            (_a = this.reconnectTimer) === null || _a === void 0 ? void 0 : _a.scheduleTimeout();\n        }\n        this._triggerStateCallbacks('close', event);\n    }\n    /** @internal */\n    _onConnError(error) {\n        this._setConnectionState('disconnected');\n        this.log('transport', `${error}`);\n        this._triggerChanError();\n        this._triggerStateCallbacks('error', error);\n    }\n    /** @internal */\n    _triggerChanError() {\n        this.channels.forEach((channel) => channel._trigger(CHANNEL_EVENTS.error));\n    }\n    /** @internal */\n    _appendParams(url, params) {\n        if (Object.keys(params).length === 0) {\n            return url;\n        }\n        const prefix = url.match(/\\?/) ? '&' : '?';\n        const query = new URLSearchParams(params);\n        return `${url}${prefix}${query}`;\n    }\n    _workerObjectUrl(url) {\n        let result_url;\n        if (url) {\n            result_url = url;\n        }\n        else {\n            const blob = new Blob([WORKER_SCRIPT], { type: 'application/javascript' });\n            result_url = URL.createObjectURL(blob);\n        }\n        return result_url;\n    }\n    /**\n     * Set connection state with proper state management\n     * @internal\n     */\n    _setConnectionState(state, manual = false) {\n        this._connectionState = state;\n        if (state === 'connecting') {\n            this._wasManualDisconnect = false;\n        }\n        else if (state === 'disconnecting') {\n            this._wasManualDisconnect = manual;\n        }\n    }\n    /**\n     * Perform the actual auth operation\n     * @internal\n     */\n    async _performAuth(token = null) {\n        let tokenToSend;\n        let isManualToken = false;\n        if (token) {\n            tokenToSend = token;\n            // Track if this is a manually-provided token\n            isManualToken = true;\n        }\n        else if (this.accessToken) {\n            // Call the accessToken callback to get fresh token\n            try {\n                tokenToSend = await this.accessToken();\n            }\n            catch (e) {\n                this.log('error', 'Error fetching access token from callback', e);\n                // Fall back to cached value if callback fails\n                tokenToSend = this.accessTokenValue;\n            }\n        }\n        else {\n            tokenToSend = this.accessTokenValue;\n        }\n        // Track whether this token was manually set or fetched via callback\n        if (isManualToken) {\n            this._manuallySetToken = true;\n        }\n        else if (this.accessToken) {\n            // If we used the callback, clear the manual flag\n            this._manuallySetToken = false;\n        }\n        if (this.accessTokenValue != tokenToSend) {\n            this.accessTokenValue = tokenToSend;\n            this.channels.forEach((channel) => {\n                const payload = {\n                    access_token: tokenToSend,\n                    version: DEFAULT_VERSION,\n                };\n                tokenToSend && channel.updateJoinPayload(payload);\n                if (channel.joinedOnce && channel._isJoined()) {\n                    channel._push(CHANNEL_EVENTS.access_token, {\n                        access_token: tokenToSend,\n                    });\n                }\n            });\n        }\n    }\n    /**\n     * Wait for any in-flight auth operations to complete\n     * @internal\n     */\n    async _waitForAuthIfNeeded() {\n        if (this._authPromise) {\n            await this._authPromise;\n        }\n    }\n    /**\n     * Safely call setAuth with standardized error handling\n     * @internal\n     */\n    _setAuthSafely(context = 'general') {\n        // Only refresh auth if using callback-based tokens\n        if (!this._isManualToken()) {\n            this.setAuth().catch((e) => {\n                this.log('error', `Error setting auth in ${context}`, e);\n            });\n        }\n    }\n    /**\n     * Trigger state change callbacks with proper error handling\n     * @internal\n     */\n    _triggerStateCallbacks(event, data) {\n        try {\n            this.stateChangeCallbacks[event].forEach((callback) => {\n                try {\n                    callback(data);\n                }\n                catch (e) {\n                    this.log('error', `error in ${event} callback`, e);\n                }\n            });\n        }\n        catch (e) {\n            this.log('error', `error triggering ${event} callbacks`, e);\n        }\n    }\n    /**\n     * Setup reconnection timer with proper configuration\n     * @internal\n     */\n    _setupReconnectionTimer() {\n        this.reconnectTimer = new Timer(async () => {\n            setTimeout(async () => {\n                await this._waitForAuthIfNeeded();\n                if (!this.isConnected()) {\n                    this.connect();\n                }\n            }, CONNECTION_TIMEOUTS.RECONNECT_DELAY);\n        }, this.reconnectAfterMs);\n    }\n    /**\n     * Initialize client options with defaults\n     * @internal\n     */\n    _initializeOptions(options) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m;\n        // Set defaults\n        this.transport = (_a = options === null || options === void 0 ? void 0 : options.transport) !== null && _a !== void 0 ? _a : null;\n        this.timeout = (_b = options === null || options === void 0 ? void 0 : options.timeout) !== null && _b !== void 0 ? _b : DEFAULT_TIMEOUT;\n        this.heartbeatIntervalMs =\n            (_c = options === null || options === void 0 ? void 0 : options.heartbeatIntervalMs) !== null && _c !== void 0 ? _c : CONNECTION_TIMEOUTS.HEARTBEAT_INTERVAL;\n        this.worker = (_d = options === null || options === void 0 ? void 0 : options.worker) !== null && _d !== void 0 ? _d : false;\n        this.accessToken = (_e = options === null || options === void 0 ? void 0 : options.accessToken) !== null && _e !== void 0 ? _e : null;\n        this.heartbeatCallback = (_f = options === null || options === void 0 ? void 0 : options.heartbeatCallback) !== null && _f !== void 0 ? _f : noop;\n        this.vsn = (_g = options === null || options === void 0 ? void 0 : options.vsn) !== null && _g !== void 0 ? _g : DEFAULT_VSN;\n        // Handle special cases\n        if (options === null || options === void 0 ? void 0 : options.params)\n            this.params = options.params;\n        if (options === null || options === void 0 ? void 0 : options.logger)\n            this.logger = options.logger;\n        if ((options === null || options === void 0 ? void 0 : options.logLevel) || (options === null || options === void 0 ? void 0 : options.log_level)) {\n            this.logLevel = options.logLevel || options.log_level;\n            this.params = Object.assign(Object.assign({}, this.params), { log_level: this.logLevel });\n        }\n        // Set up functions with defaults\n        this.reconnectAfterMs =\n            (_h = options === null || options === void 0 ? void 0 : options.reconnectAfterMs) !== null && _h !== void 0 ? _h : ((tries) => {\n                return RECONNECT_INTERVALS[tries - 1] || DEFAULT_RECONNECT_FALLBACK;\n            });\n        switch (this.vsn) {\n            case VSN_1_0_0:\n                this.encode =\n                    (_j = options === null || options === void 0 ? void 0 : options.encode) !== null && _j !== void 0 ? _j : ((payload, callback) => {\n                        return callback(JSON.stringify(payload));\n                    });\n                this.decode =\n                    (_k = options === null || options === void 0 ? void 0 : options.decode) !== null && _k !== void 0 ? _k : ((payload, callback) => {\n                        return callback(JSON.parse(payload));\n                    });\n                break;\n            case VSN_2_0_0:\n                this.encode = (_l = options === null || options === void 0 ? void 0 : options.encode) !== null && _l !== void 0 ? _l : this.serializer.encode.bind(this.serializer);\n                this.decode = (_m = options === null || options === void 0 ? void 0 : options.decode) !== null && _m !== void 0 ? _m : this.serializer.decode.bind(this.serializer);\n                break;\n            default:\n                throw new Error(`Unsupported serializer version: ${this.vsn}`);\n        }\n        // Handle worker setup\n        if (this.worker) {\n            if (typeof window !== 'undefined' && !window.Worker) {\n                throw new Error('Web Worker is not supported');\n            }\n            this.workerUrl = options === null || options === void 0 ? void 0 : options.workerUrl;\n        }\n    }\n}\n//# sourceMappingURL=RealtimeClient.js.map"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2342, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}