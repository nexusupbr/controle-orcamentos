(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{13008:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a(62898).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},83523:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a(62898).Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},9224:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a(62898).Z)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]])},78083:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a(62898).Z)("HardHat",[["path",{d:"M2 18a1 1 0 0 0 1 1h18a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v2z",key:"1dej2m"}],["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6h0",key:"1uc279"}],["path",{d:"M14 6h0a6 6 0 0 1 6 6v3",key:"1j9mnm"}]])},86264:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a(62898).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},4322:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a(62898).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},33101:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a(62898).Z)("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]])},94136:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a(62898).Z)("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]])},94900:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a(62898).Z)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]])},9883:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a(62898).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},98501:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a(62898).Z)("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]])},41827:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a(62898).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},92851:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a(62898).Z)("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]])},45367:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a(62898).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},82549:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a(62898).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},71561:function(e,t,a){Promise.resolve().then(a.bind(a,91823))},91823:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return C}});var n=a(57437),r=a(2265),i=a(94900),s=a(33101),o=a(13008),l=a(9883),c=a(41827),d=a(9224),u=a(83523),m=a(78083);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let x=(0,a(62898).Z)("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);var f=a(4322),h=a(94136),p=a(45367),g=a(98501),b=a(66651),v=a(47049),y=a(70492),j=a(548),w=a(14958);let N=[{value:"em_andamento",label:"Em Andamento"},{value:"pausada",label:"Pausada"},{value:"concluida",label:"Conclu\xedda"}],k={em_andamento:{variant:"success",icon:(0,n.jsx)(i.Z,{className:"w-3 h-3"})},pausada:{variant:"warning",icon:(0,n.jsx)(s.Z,{className:"w-3 h-3"})},concluida:{variant:"primary",icon:(0,n.jsx)(o.Z,{className:"w-3 h-3"})}};function C(){var e;let[t,a]=(0,r.useState)([]),[i,s]=(0,r.useState)([]),[o,C]=(0,r.useState)([]),[E,O]=(0,r.useState)(!0),[S,A]=(0,r.useState)(!1),[M,Z]=(0,r.useState)(""),[I,D]=(0,r.useState)(""),[L,R]=(0,r.useState)(null),[T,q]=(0,r.useState)([]),[z,_]=(0,r.useState)(!1),[P,U]=(0,r.useState)(null),[G,F]=(0,r.useState)({orcamento_id:void 0,nome:"",descricao:"",status:"em_andamento"}),[B,J]=(0,r.useState)(null);(0,r.useEffect)(()=>{Q()},[]),(0,r.useEffect)(()=>{let e=t;M&&(e=e.filter(e=>{var t;return e.nome.toLowerCase().includes(M.toLowerCase())||(null===(t=e.descricao)||void 0===t?void 0:t.toLowerCase().includes(M.toLowerCase()))})),I&&(e=e.filter(e=>e.status===I)),C(e)},[t,M,I]);let Q=async()=>{try{O(!0);let[e,t,n]=await Promise.all([(0,w.r0)(),(0,w.SL)(),(0,w.SE)()]);a(e),s(t),q(n)}catch(e){console.error("Erro ao carregar dados:",e)}finally{O(!1)}},K=async e=>{if(L===e){R(null);return}R(e);let n=t.find(t=>t.id===e);if(null==n||!n.materiaisCarregados){a(t=>t.map(t=>t.id===e?{...t,loadingMateriais:!0}:t));try{let t=await (0,w.Qf)(e);a(a=>a.map(a=>a.id===e?{...a,materiaisCarregados:t,loadingMateriais:!1}:a))}catch(t){console.error("Erro ao carregar materiais:",t),a(t=>t.map(t=>t.id===e?{...t,loadingMateriais:!1}:t))}}},V=async e=>{var t;let n=e.materiaisCarregados;if(!n)try{n=await (0,w.Qf)(e.id),a(t=>t.map(t=>t.id===e.id?{...t,materiaisCarregados:n,loadingMateriais:!1}:t))}catch(e){console.error("Erro ao carregar materiais para impress\xe3o:",e),alert("Erro ao carregar materiais para impress\xe3o");return}let r=X(e.orcamento_id),i=(null==n?void 0:n.filter(e=>e.quantidade>0))||[],s=new Date().toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),o=(null===(t=N.find(t=>t.value===e.status))||void 0===t?void 0:t.label)||e.status,l=window.open("","_blank");if(!l){alert("Popup bloqueado. Permita popups para imprimir.");return}l.document.write('\n      <!DOCTYPE html>\n      <html lang="pt-BR">\n      <head>\n        <meta charset="UTF-8">\n        <meta name="viewport" content="width=device-width, initial-scale=1.0">\n        <title>Relat\xf3rio de Materiais - '.concat(e.nome,'</title>\n        <style>\n          * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n          }\n          body {\n            font-family: \'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif;\n            padding: 20px;\n            color: #333;\n            line-height: 1.5;\n          }\n          .header {\n            text-align: center;\n            border-bottom: 2px solid #333;\n            padding-bottom: 15px;\n            margin-bottom: 20px;\n          }\n          .header h1 {\n            font-size: 24px;\n            margin-bottom: 5px;\n            color: #1a1a1a;\n          }\n          .header p {\n            color: #666;\n            font-size: 12px;\n          }\n          .info-section {\n            background: #f5f5f5;\n            padding: 15px;\n            border-radius: 8px;\n            margin-bottom: 20px;\n          }\n          .info-grid {\n            display: grid;\n            grid-template-columns: repeat(2, 1fr);\n            gap: 10px;\n          }\n          .info-item {\n            margin-bottom: 8px;\n          }\n          .info-label {\n            font-weight: 600;\n            color: #555;\n            font-size: 12px;\n            text-transform: uppercase;\n          }\n          .info-value {\n            color: #1a1a1a;\n            font-size: 14px;\n          }\n          .status-badge {\n            display: inline-block;\n            padding: 4px 12px;\n            border-radius: 20px;\n            font-size: 12px;\n            font-weight: 600;\n          }\n          .status-em_andamento { background: #dcfce7; color: #166534; }\n          .status-pausada { background: #fef3c7; color: #92400e; }\n          .status-concluida { background: #dbeafe; color: #1e40af; }\n          \n          .materials-title {\n            font-size: 16px;\n            font-weight: 600;\n            margin-bottom: 15px;\n            padding-bottom: 8px;\n            border-bottom: 1px solid #ddd;\n          }\n          .materials-table {\n            width: 100%;\n            border-collapse: collapse;\n            margin-bottom: 20px;\n          }\n          .materials-table th,\n          .materials-table td {\n            padding: 10px 12px;\n            text-align: left;\n            border-bottom: 1px solid #ddd;\n          }\n          .materials-table th {\n            background: #f0f0f0;\n            font-weight: 600;\n            font-size: 12px;\n            text-transform: uppercase;\n            color: #555;\n          }\n          .materials-table tr:hover {\n            background: #f9f9f9;\n          }\n          .materials-table .qty {\n            text-align: center;\n            font-weight: 600;\n            color: #1a1a1a;\n          }\n          .materials-table .idx {\n            text-align: center;\n            color: #888;\n            width: 40px;\n          }\n          .empty-message {\n            text-align: center;\n            padding: 30px;\n            color: #888;\n            font-style: italic;\n          }\n          .footer {\n            margin-top: 30px;\n            padding-top: 15px;\n            border-top: 1px solid #ddd;\n            display: flex;\n            justify-content: space-between;\n            font-size: 11px;\n            color: #888;\n          }\n          .signature-area {\n            margin-top: 50px;\n            display: flex;\n            justify-content: space-between;\n          }\n          .signature-box {\n            text-align: center;\n            width: 200px;\n          }\n          .signature-line {\n            border-top: 1px solid #333;\n            margin-top: 50px;\n            padding-top: 5px;\n            font-size: 12px;\n          }\n          .total-items {\n            text-align: right;\n            font-size: 14px;\n            margin-top: 10px;\n            font-weight: 600;\n          }\n          @media print {\n            body { padding: 10px; }\n            .no-print { display: none; }\n          }\n        </style>\n      </head>\n      <body>\n        <div class="header">\n          <h1>\uD83D\uDCCB Relat\xf3rio de Materiais</h1>\n          <p>Checklist de materiais utilizados na obra</p>\n        </div>\n        \n        <div class="info-section">\n          <div class="info-grid">\n            <div class="info-item">\n              <div class="info-label">Nome da Obra</div>\n              <div class="info-value">').concat(e.nome,'</div>\n            </div>\n            <div class="info-item">\n              <div class="info-label">Status</div>\n              <div class="info-value">\n                <span class="status-badge status-').concat(e.status,'">').concat(o,'</span>\n              </div>\n            </div>\n            <div class="info-item">\n              <div class="info-label">Cliente / Or\xe7amento</div>\n              <div class="info-value">').concat(r?"".concat(r.cliente," (Or\xe7. #").concat(r.id,")"):"N\xe3o vinculado",'</div>\n            </div>\n            <div class="info-item">\n              <div class="info-label">Data do Relat\xf3rio</div>\n              <div class="info-value">').concat(s,"</div>\n            </div>\n            ").concat(e.descricao?'\n            <div class="info-item" style="grid-column: span 2;">\n              <div class="info-label">Descri\xe7\xe3o</div>\n              <div class="info-value">'.concat(e.descricao,"</div>\n            </div>\n            "):"",'\n          </div>\n        </div>\n        \n        <div class="materials-title">\uD83D\uDCE6 Materiais Utilizados</div>\n        \n        ').concat(i.length>0?'\n          <table class="materials-table">\n            <thead>\n              <tr>\n                <th class="idx">#</th>\n                <th>Material</th>\n                <th class="qty">Quantidade</th>\n                <th>Conferido</th>\n              </tr>\n            </thead>\n            <tbody>\n              '.concat(i.map((e,t)=>{var a;return'\n                <tr>\n                  <td class="idx">'.concat(t+1,"</td>\n                  <td>").concat((null===(a=e.material)||void 0===a?void 0:a.nome)||"Material #".concat(e.material_id),'</td>\n                  <td class="qty">').concat(e.quantidade,' un</td>\n                  <td style="width: 80px;">☐</td>\n                </tr>\n              ')}).join(""),'\n            </tbody>\n          </table>\n          <div class="total-items">\n            Total: ').concat(i.length," ").concat(1===i.length?"item":"itens"," | \n            ").concat(i.reduce((e,t)=>e+t.quantidade,0)," unidades\n          </div>\n        "):'\n          <div class="empty-message">\n            Nenhum material registrado para esta obra\n          </div>\n        ','\n        \n        <div class="signature-area">\n          <div class="signature-box">\n            <div class="signature-line">Respons\xe1vel pela Obra</div>\n          </div>\n          <div class="signature-box">\n            <div class="signature-line">Conferente</div>\n          </div>\n        </div>\n        \n        <div class="footer">\n          <span>Obra #').concat(e.id,"</span>\n          <span>Gerado em: ").concat(s,"</span>\n        </div>\n        \n        <script>\n          window.onload = function() {\n            window.print();\n          }\n        </script>\n      </body>\n      </html>\n    ")),l.document.close()},X=e=>e?i.find(t=>t.id===e):null,W=e=>{J(null),e?(U(e.id),F({orcamento_id:e.orcamento_id,nome:e.nome,descricao:e.descricao||"",status:e.status})):(U(null),F({orcamento_id:void 0,nome:"",descricao:"",status:"em_andamento"})),_(!0)},Y=()=>{_(!1),U(null),F({orcamento_id:void 0,nome:"",descricao:"",status:"em_andamento"}),J(null)},H=async e=>{e.preventDefault(),A(!0),J(null);try{P?await (0,w.y5)(P,G):await (0,w.AE)(G),await Q(),Y()}catch(e){console.error("Erro ao salvar:",e),J(e instanceof Error?e.message:"Erro ao salvar obra")}finally{A(!1)}},$=async e=>{if(confirm("Tem certeza que deseja excluir esta obra? Os registros de materiais associados tamb\xe9m ser\xe3o exclu\xeddos."))try{await (0,w.gQ)(e),await Q()}catch(e){console.error("Erro ao excluir:",e),alert("Erro ao excluir obra.")}};return E?(0,n.jsx)("div",{className:"flex items-center justify-center h-[60vh]",children:(0,n.jsx)(j.TK,{size:"lg"})}):(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl lg:text-3xl font-bold font-heading text-white",children:"Obras"}),(0,n.jsx)("p",{className:"text-dark-400 mt-1",children:"Gerencie as obras vinculadas aos or\xe7amentos"})]}),(0,n.jsx)(b.z,{onClick:()=>W(),leftIcon:(0,n.jsx)(l.Z,{className:"w-5 h-5"}),children:"Nova Obra"})]}),(0,n.jsx)("div",{className:"glass-card p-4",children:(0,n.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,n.jsxs)("div",{className:"relative flex-1",children:[(0,n.jsx)(c.Z,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-dark-400"}),(0,n.jsx)("input",{type:"text",placeholder:"Buscar obra...",value:M,onChange:e=>Z(e.target.value),className:"input pl-12 w-full"})]}),(0,n.jsxs)("select",{value:I,onChange:e=>D(e.target.value),className:"input w-full md:w-48",children:[(0,n.jsx)("option",{value:"",children:"Todos os Status"}),N.map(e=>(0,n.jsx)("option",{value:e.value,children:e.label},e.value))]})]})}),(0,n.jsx)("div",{className:"glass-card overflow-hidden",children:o.length>0?(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"data-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"w-10"}),(0,n.jsx)("th",{children:"ID"}),(0,n.jsx)("th",{children:"Nome da Obra"}),(0,n.jsx)("th",{children:"Or\xe7amento Vinculado"}),(0,n.jsx)("th",{children:"Status"}),(0,n.jsx)("th",{children:"Materiais"}),(0,n.jsx)("th",{className:"text-right",children:"A\xe7\xf5es"})]})}),(0,n.jsx)("tbody",{children:o.map(e=>{var t,a;let r=X(e.orcamento_id),i=k[e.status]||k.em_andamento,s=L===e.id,o=(null===(t=e.materiaisCarregados)||void 0===t?void 0:t.filter(e=>e.quantidade>0).length)||0;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("tr",{className:"group",children:[(0,n.jsx)("td",{className:"w-10",children:(0,n.jsx)("button",{onClick:()=>K(e.id),className:"p-1.5 rounded-lg text-dark-400 hover:text-primary-400 hover:bg-primary-500/10 transition-colors",title:s?"Ocultar materiais":"Ver materiais",children:s?(0,n.jsx)(d.Z,{className:"w-4 h-4"}):(0,n.jsx)(u.Z,{className:"w-4 h-4"})})}),(0,n.jsxs)("td",{className:"text-dark-400 w-20",children:["#",e.id]}),(0,n.jsx)("td",{children:(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"w-10 h-10 rounded-lg bg-accent-500/10 flex items-center justify-center",children:(0,n.jsx)(m.Z,{className:"w-5 h-5 text-accent-400"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-medium text-white block",children:e.nome}),e.descricao&&(0,n.jsxs)("span",{className:"text-xs text-dark-400",children:[e.descricao.substring(0,50),e.descricao.length>50?"...":""]})]})]})}),(0,n.jsx)("td",{children:r?(0,n.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,n.jsx)(x,{className:"w-4 h-4 text-primary-400"}),(0,n.jsx)("span",{className:"text-white",children:r.cliente})]}):(0,n.jsx)("span",{className:"text-dark-500 text-sm",children:"N\xe3o vinculado"})}),(0,n.jsx)("td",{children:(0,n.jsx)(j.Ct,{variant:i.variant,children:(0,n.jsxs)("span",{className:"flex items-center gap-1.5",children:[i.icon,(null===(a=N.find(t=>t.value===e.status))||void 0===a?void 0:a.label)||e.status]})})}),(0,n.jsx)("td",{children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(f.Z,{className:"w-4 h-4 text-dark-400"}),(0,n.jsx)("span",{className:"text-sm text-dark-300",children:e.materiaisCarregados?"".concat(o," ").concat(1===o?"item":"itens"):(0,n.jsx)("span",{className:"text-dark-500",children:"Clique para ver"})})]})}),(0,n.jsx)("td",{children:(0,n.jsxs)("div",{className:"flex items-center justify-end gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,n.jsx)("button",{onClick:()=>W(e),className:"p-2 rounded-lg text-dark-400 hover:text-primary-400 hover:bg-primary-500/10 transition-colors",title:"Editar",children:(0,n.jsx)(h.Z,{className:"w-4 h-4"})}),(0,n.jsx)("button",{onClick:()=>$(e.id),className:"p-2 rounded-lg text-dark-400 hover:text-red-400 hover:bg-red-500/10 transition-colors",title:"Excluir",children:(0,n.jsx)(p.Z,{className:"w-4 h-4"})})]})})]},e.id),s&&(0,n.jsx)("tr",{className:"bg-dark-800/50",children:(0,n.jsx)("td",{colSpan:7,className:"p-0",children:(0,n.jsxs)("div",{className:"p-4 border-t border-dark-700",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,n.jsxs)("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[(0,n.jsx)(f.Z,{className:"w-4 h-4 text-primary-400"}),"Materiais Utilizados"]}),(0,n.jsxs)("button",{onClick:()=>V(e),className:"flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm bg-primary-500/10 text-primary-400 hover:bg-primary-500/20 transition-colors",title:"Imprimir relat\xf3rio de materiais",children:[(0,n.jsx)(g.Z,{className:"w-4 h-4"}),"Imprimir Relat\xf3rio"]})]}),e.loadingMateriais?(0,n.jsxs)("div",{className:"flex items-center justify-center py-4",children:[(0,n.jsx)(j.TK,{size:"sm"}),(0,n.jsx)("span",{className:"ml-2 text-sm text-dark-400",children:"Carregando materiais..."})]}):e.materiaisCarregados&&e.materiaisCarregados.filter(e=>e.quantidade>0).length>0?(0,n.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3",children:e.materiaisCarregados.filter(e=>e.quantidade>0).map(e=>{var t;return(0,n.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-dark-700/50 border border-dark-600",children:[(0,n.jsx)("span",{className:"text-sm text-white",children:(null===(t=e.material)||void 0===t?void 0:t.nome)||"Material #".concat(e.material_id)}),(0,n.jsxs)("span",{className:"text-sm font-semibold text-primary-400 ml-2",children:[e.quantidade," un"]})]},e.material_id)})}):(0,n.jsx)("div",{className:"text-center py-4 text-dark-500 text-sm",children:"Nenhum material registrado para esta obra"})]})})},"".concat(e.id,"-materiais"))]})})})]})}):(0,n.jsx)(j.ub,{icon:(0,n.jsx)(m.Z,{className:"w-10 h-10 text-dark-500"}),title:"Nenhuma obra cadastrada",description:"Adicione obras para gerenciar materiais",action:(0,n.jsx)(b.z,{onClick:()=>W(),leftIcon:(0,n.jsx)(l.Z,{className:"w-4 h-4"}),children:"Nova Obra"})})}),(0,n.jsxs)("div",{className:"text-sm text-dark-400 text-center",children:["Total: ",o.length," ",1===o.length?"obra":"obras"]}),(0,n.jsx)(y.u,{isOpen:z,onClose:Y,title:P?"Editar Obra":"Nova Obra",size:"lg",children:(0,n.jsxs)("form",{onSubmit:H,className:"space-y-5",children:[B&&(0,n.jsx)("div",{className:"p-3 rounded-lg bg-red-500/10 border border-red-500/20 text-sm text-red-300",children:B}),(0,n.jsx)(v.II,{label:"Nome da Obra",placeholder:"Ex: Reforma Apartamento 302",required:!0,value:G.nome,onChange:e=>F({...G,nome:e.target.value})}),(0,n.jsxs)(v.Wh,{label:"Or\xe7amento Vinculado",value:(null===(e=G.orcamento_id)||void 0===e?void 0:e.toString())||"",onChange:e=>F({...G,orcamento_id:e.target.value?Number(e.target.value):void 0}),children:[(0,n.jsx)("option",{value:"",children:"Selecione um or\xe7amento (opcional)"}),i.map(e=>(0,n.jsxs)("option",{value:e.id,children:["#",e.id," - ",e.cliente]},e.id))]}),(0,n.jsx)(v.Wh,{label:"Status",required:!0,value:G.status,onChange:e=>F({...G,status:e.target.value}),children:N.map(e=>(0,n.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,n.jsx)(v.Kx,{label:"Descri\xe7\xe3o",placeholder:"Detalhes sobre a obra...",value:G.descricao||"",onChange:e=>F({...G,descricao:e.target.value}),rows:3}),(0,n.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t border-dark-700",children:[(0,n.jsx)(b.z,{type:"button",variant:"secondary",onClick:Y,children:"Cancelar"}),(0,n.jsx)(b.z,{type:"submit",isLoading:S,children:P?"Salvar Altera\xe7\xf5es":"Cadastrar Obra"})]})]})})]})}},66651:function(e,t,a){"use strict";a.d(t,{z:function(){return s}});var n=a(57437),r=a(86264),i=a(22169);function s(e){let{children:t,className:a,variant:s="primary",size:o="md",isLoading:l=!1,leftIcon:c,rightIcon:d,disabled:u,...m}=e;return(0,n.jsxs)("button",{className:(0,i.cn)("btn",{primary:"btn-primary",secondary:"btn-secondary",danger:"btn-danger",success:"btn-success",ghost:"btn-ghost"}[s],{sm:"px-3 py-1.5 text-xs",md:"px-4 py-2.5 text-sm",lg:"px-6 py-3 text-base"}[o],a),disabled:u||l,...m,children:[l?(0,n.jsx)(r.Z,{className:"w-4 h-4 animate-spin"}):c,t,!l&&d]})}},548:function(e,t,a){"use strict";a.d(t,{Ct:function(){return l},TK:function(){return o},ub:function(){return s}});var n=a(57437),r=a(22169),i=a(92851);function s(e){let{icon:t,title:a,description:r,action:s}=e;return(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 px-4 text-center",children:[(0,n.jsx)("div",{className:"w-20 h-20 rounded-2xl bg-dark-800 flex items-center justify-center mb-6",children:t||(0,n.jsx)(i.Z,{className:"w-10 h-10 text-dark-500"})}),(0,n.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:a}),r&&(0,n.jsx)("p",{className:"text-dark-400 max-w-sm mb-6",children:r}),s]})}function o(e){let{size:t="md"}=e;return(0,n.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,n.jsx)("div",{className:(0,r.cn)("rounded-full border-dark-700 border-t-primary-500 animate-spin",{sm:"w-6 h-6 border-2",md:"w-10 h-10 border-3",lg:"w-16 h-16 border-4"}[t])})})}function l(e){let{children:t,variant:a="success",size:i="md",className:s}=e;return(0,n.jsx)("span",{className:(0,r.cn)("badge",{success:"badge-success",danger:"badge-danger",warning:"badge-warning",info:"badge-info",primary:"badge-info",secondary:"bg-dark-600 text-dark-300"}[a],{sm:"text-xs px-1.5 py-0.5",md:"text-xs px-2 py-1",lg:"text-sm px-3 py-1.5"}[i],s),children:t})}},47049:function(e,t,a){"use strict";a.d(t,{II:function(){return s},Kx:function(){return c},Ph:function(){return o},Wh:function(){return l}});var n=a(57437),r=a(22169),i=a(2265);let s=(0,i.forwardRef)((e,t)=>{let{className:a,label:i,error:s,required:o,type:l,...c}=e;return(0,n.jsxs)("div",{className:"space-y-1.5",children:[i&&(0,n.jsx)("label",{className:(0,r.cn)("label",o&&"label-required"),children:i}),(0,n.jsx)("input",{type:l,className:(0,r.cn)("input",s&&"border-red-500 focus:border-red-500 focus:ring-red-500/20",a),ref:t,...c}),s&&(0,n.jsx)("p",{className:"text-xs text-red-400 mt-1",children:s})]})});s.displayName="Input";let o=(0,i.forwardRef)((e,t)=>{let{className:a,label:i,error:s,required:o,options:l,...c}=e;return(0,n.jsxs)("div",{className:"space-y-1.5",children:[i&&(0,n.jsx)("label",{className:(0,r.cn)("label",o&&"label-required"),children:i}),(0,n.jsx)("select",{className:(0,r.cn)("select",s&&"border-red-500 focus:border-red-500 focus:ring-red-500/20",a),ref:t,...c,children:l.map(e=>(0,n.jsx)("option",{value:e.value,children:e.label},e.value))}),s&&(0,n.jsx)("p",{className:"text-xs text-red-400 mt-1",children:s})]})});o.displayName="Select";let l=(0,i.forwardRef)((e,t)=>{let{className:a,label:i,error:s,required:o,children:l,...c}=e;return(0,n.jsxs)("div",{className:"space-y-1.5",children:[i&&(0,n.jsx)("label",{className:(0,r.cn)("label",o&&"label-required"),children:i}),(0,n.jsx)("select",{className:(0,r.cn)("select",s&&"border-red-500 focus:border-red-500 focus:ring-red-500/20",a),ref:t,...c,children:l}),s&&(0,n.jsx)("p",{className:"text-xs text-red-400 mt-1",children:s})]})});l.displayName="SelectChildren";let c=(0,i.forwardRef)((e,t)=>{let{className:a,label:i,error:s,required:o,...l}=e;return(0,n.jsxs)("div",{className:"space-y-1.5",children:[i&&(0,n.jsx)("label",{className:(0,r.cn)("label",o&&"label-required"),children:i}),(0,n.jsx)("textarea",{className:(0,r.cn)("input min-h-[80px] resize-y",s&&"border-red-500 focus:border-red-500 focus:ring-red-500/20",a),ref:t,...l}),s&&(0,n.jsx)("p",{className:"text-xs text-red-400 mt-1",children:s})]})});c.displayName="TextArea",(0,i.forwardRef)((e,t)=>{let{className:a,label:i,...s}=e;return(0,n.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer group",children:[(0,n.jsx)("input",{type:"checkbox",className:(0,r.cn)("checkbox",a),ref:t,...s}),i&&(0,n.jsx)("span",{className:"text-sm text-dark-300 group-hover:text-white transition-colors",children:i})]})}).displayName="Checkbox"},70492:function(e,t,a){"use strict";a.d(t,{u:function(){return o}});var n=a(57437),r=a(82549),i=a(2265),s=a(22169);function o(e){let{isOpen:t,onClose:a,title:o,children:l,size:c="md"}=e;return((0,i.useEffect)(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[t]),t)?(0,n.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,n.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm animate-fade-in",onClick:a}),(0,n.jsxs)("div",{className:(0,s.cn)("relative w-full bg-dark-900 border border-dark-700 rounded-2xl shadow-2xl animate-slide-up",{sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"}[c]),children:[(0,n.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-dark-700",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-white",children:o}),(0,n.jsx)("button",{onClick:a,className:"p-2 rounded-xl text-dark-400 hover:text-white hover:bg-dark-800 transition-colors",children:(0,n.jsx)(r.Z,{className:"w-5 h-5"})})]}),(0,n.jsx)("div",{className:"px-6 py-6 max-h-[70vh] overflow-y-auto scrollbar-thin",children:l})]})]}):null}},14958:function(e,t,a){"use strict";a.d(t,{AE:function(){return f},AT:function(){return w},FZ:function(){return y},GL:function(){return o},Gx:function(){return u},JA:function(){return s},Kx:function(){return v},OQ:function(){return n},Qf:function(){return g},S3:function(){return N},SE:function(){return l},SL:function(){return r},VR:function(){return d},gQ:function(){return p},hM:function(){return c},mU:function(){return j},nx:function(){return i},r0:function(){return m},uY:function(){return x},y5:function(){return h},zM:function(){return b}});let n=(0,a(69073).eI)("https://yhiiupamxdjmnrktkjku.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InloaWl1cGFteGRqbW5ya3Rramt1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg0ODg2NzUsImV4cCI6MjA4NDA2NDY3NX0._QjYtYAlypJdursHe0-rPz14QOT4NNP2EklqcJ6TpkI");async function r(){let{data:e,error:t}=await n.from("orcamentos").select("*").order("data",{ascending:!1});if(t)throw console.error("Erro ao buscar or\xe7amentos:",t),t;return e||[]}async function i(e){let{data:t,error:a}=await n.from("orcamentos").insert([e]).select().single();if(a)throw console.error("Erro ao criar or\xe7amento:",a),Error(a.message);return t}async function s(e,t){let{data:a,error:r}=await n.from("orcamentos").update(t).eq("id",e).select().single();if(r)throw console.error("Erro ao atualizar or\xe7amento:",r),Error(r.message);return a}async function o(e){let{error:t}=await n.from("orcamentos").delete().eq("id",e);if(t)throw console.error("Erro ao excluir or\xe7amento:",t),Error(t.message)}async function l(){let{data:e,error:t}=await n.from("materiais").select("*").order("nome",{ascending:!0});if(t)throw console.error("Erro ao buscar materiais:",t),t;return e||[]}async function c(e){let{data:t,error:a}=await n.from("materiais").insert([e]).select().single();if(a)throw console.error("Erro ao criar material:",a),Error(a.message);return t}async function d(e,t){let{data:a,error:r}=await n.from("materiais").update(t).eq("id",e).select().single();if(r)throw console.error("Erro ao atualizar material:",r),Error(r.message);return a}async function u(e){let{error:t}=await n.from("materiais").delete().eq("id",e);if(t)throw console.error("Erro ao excluir material:",t),Error(t.message)}async function m(){let{data:e,error:t}=await n.from("obras").select("\n      *,\n      orcamento:orcamentos(id, cliente, status)\n    ").order("created_at",{ascending:!1});if(t)throw console.error("Erro ao buscar obras:",t),t;return e||[]}async function x(){let{data:e,error:t}=await n.from("obras").select("\n      *,\n      orcamento:orcamentos(id, cliente)\n    ").eq("status","em_andamento").order("created_at",{ascending:!1});if(t)throw console.error("Erro ao buscar obras em andamento:",t),t;return e||[]}async function f(e){let{data:t,error:a}=await n.from("obras").insert([e]).select().single();if(a)throw console.error("Erro ao criar obra:",a),Error(a.message);return t}async function h(e,t){let{data:a,error:r}=await n.from("obras").update(t).eq("id",e).select().single();if(r)throw console.error("Erro ao atualizar obra:",r),Error(r.message);return a}async function p(e){let{error:t}=await n.from("obras").delete().eq("id",e);if(t)throw console.error("Erro ao excluir obra:",t),Error(t.message)}async function g(e){let{data:t,error:a}=await n.from("obra_materiais").select("\n      *,\n      material:materiais(id, nome)\n    ").eq("obra_id",e);if(a)throw console.error("Erro ao buscar materiais da obra:",a),a;return t||[]}async function b(e){let{data:t}=await n.from("obra_materiais").select("id").eq("obra_id",e.obra_id).eq("material_id",e.material_id).single();if(t){let{data:a,error:r}=await n.from("obra_materiais").update({quantidade:e.quantidade}).eq("id",t.id).select().single();if(r)throw Error(r.message);return a}{let{data:t,error:a}=await n.from("obra_materiais").insert([e]).select().single();if(a)throw Error(a.message);return t}}async function v(e,t){let{data:a,error:r}=await n.from("usuarios").select("*").ilike("email",e.trim()).eq("senha",t).single();return r?(console.error("Erro no login:",r),null):a}async function y(){let{data:e,error:t}=await n.from("usuarios").select("*").order("nome",{ascending:!0});if(t)throw console.error("Erro ao buscar usu\xe1rios:",t),t;return e||[]}async function j(e){let{data:t,error:a}=await n.from("usuarios").insert([e]).select().single();if(a)throw console.error("Erro ao criar usu\xe1rio:",a),Error(a.message);return t}async function w(e,t){let{data:a,error:r}=await n.from("usuarios").update(t).eq("id",e).select().single();if(r)throw console.error("Erro ao atualizar usu\xe1rio:",r),Error(r.message);return a}async function N(e){let{error:t}=await n.from("usuarios").delete().eq("id",e);if(t)throw console.error("Erro ao excluir usu\xe1rio:",t),Error(t.message)}},22169:function(e,t,a){"use strict";a.d(t,{K3:function(){return x},T3:function(){return l},Wi:function(){return d},Wt:function(){return u},cn:function(){return i},d5:function(){return c},fj:function(){return m},p6:function(){return o},xG:function(){return s},zm:function(){return p}});var n=a(57042),r=a(74769);function i(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.m6)((0,n.W)(t))}function s(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:2,maximumFractionDigits:2}).format(e)}function o(e){if(!e)return"-";let t=new Date(e);return isNaN(t.getTime())?"-":t.toLocaleDateString("pt-BR")}function l(e){return"".concat(e.toFixed(1),"%")}function c(e,t){return t&&0!==t?e/t*100:0}function d(e){return("string"==typeof e?parseFloat(e)||0:e).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}function u(e){return e&&parseFloat(e.replace(/\./g,"").replace(",","."))||0}function m(e){let t=e.replace(/\D/g,"");return t?(parseInt(t)/100).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""}function x(e){return"".concat("/controle-orcamentos").concat(e)}let f=["UN","PC","KG","G","L","ML","M","CM","M2","M3","CX","PAR","SC","FD","PCT","RL","TON","DZ","CT","BD","JG","KIT","AMPOLA","UNID","PECA","METRO","LITRO","QUILO","CAIXA","SACO","FARDO","PACOTE","ROLO","DUZIA","CARTELA","BALDE","JOGO"],h={UNID:"UN",UNIDADE:"UN",UNIDADES:"UN",PECA:"PC",PEÇA:"PC",PECAS:"PC",PEÇAS:"PC",METRO:"M",METROS:"M",LITRO:"L",LITROS:"L",QUILO:"KG",QUILOS:"KG",QUILOGRAMA:"KG",QUILOGRAMAS:"KG",GRAMA:"G",GRAMAS:"G",MILILITRO:"ML",MILILITROS:"ML",CENTIMETRO:"CM",CENTIMETROS:"CM",CENTÍMETRO:"CM",CENTÍMETROS:"CM",CAIXA:"CX",CAIXAS:"CX",SACO:"SC",SACOS:"SC",FARDO:"FD",FARDOS:"FD",PACOTE:"PCT",PACOTES:"PCT",ROLO:"RL",ROLOS:"RL",TONELADA:"TON",TONELADAS:"TON",DUZIA:"DZ",DÚZIA:"DZ",DUZIAS:"DZ",CARTELA:"CT",CARTELAS:"CT",BALDE:"BD",BALDES:"BD",JOGO:"JG",JOGOS:"JG"};function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"UN";if(null==e)return t;if("number"==typeof e)return console.warn("[normalizeUnidade] Valor num\xe9rico recebido: ".concat(e,". Usando default: ").concat(t)),t;let a=String(e).trim().toUpperCase();if(!a)return t;if(/^\d+$/.test(a))return console.warn('[normalizeUnidade] String num\xe9rica recebida: "'.concat(e,'". Usando default: ').concat(t)),t;if(h[a])return h[a];if(f.includes(a))return a;let n=a.split(/\s+/)[0];return f.includes(n)?n:h[n]?h[n]:(console.warn('[normalizeUnidade] Unidade desconhecida: "'.concat(e,'". Usando default: ').concat(t)),t)}}},function(e){e.O(0,[149,985,971,938,744],function(){return e(e.s=71561)}),_N_E=e.O()}]);